!function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)a=s[d],o[a]&&p.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={3:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push(["./examples/example.tsx",0,1]),n()}({"./examples/example.tsx":function(e,t,n){"use strict";var r,o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n("./node_modules/react/index.js"),u=n("./node_modules/react-dom/index.js"),l=n("./node_modules/semantic-ui-react/dist/es/index.js"),d=n("./src/component/ContactMap.tsx"),p=n("./src/component/NGLComponent.tsx"),f=n("./src/component/PredictedContactMap.tsx"),h=n("./src/context/CouplingContext.tsx"),y=n("./src/context/ResidueContext.tsx"),v=n("./src/data/chell-data.ts"),g=n("./src/data/ChellPDB.ts"),m=n("./src/data/CouplingContainer.ts"),C=n("./src/helper/DataHelper.ts"),_=n("./src/helper/FetchHelper.ts"),S=n("./src/helper/ResidueMapper.ts"),x=function(e){function t(n){var r=e.call(this,n)||this;return r.renderCouplingComponents=function(e,t){var n=(void 0===e?r.props:e).style,o=void 0===t?r.state:t,a=o.arePredictionsAvailable,s=o.errorMsg,u=o.isResidueMappingNeeded,g=o.pdbData;return c.createElement("div",null,c.createElement(l.Header,{as:"h1",attached:"top"},"Chell - ContactMap.IO"),s.length>1&&r.renderErrorMessage(),c.createElement(l.Segment,{attached:!0,raised:!0},c.createElement(h.CouplingContextClass,null,c.createElement(y.ResidueContextWrapper.Consumer,null,function(e){return c.createElement(l.Grid,{centered:!0},c.createElement(l.GridRow,{verticalAlign:"middle"},c.createElement(l.GridColumn,{width:6},c.createElement(p.NGLComponent,{data:r.state[v.VIZ_TYPE.NGL].pdbData,isDataLoading:r.state[v.VIZ_TYPE.NGL].isLoading,measuredProximity:r.state.measuredProximity,style:i({},n,{width:400})})),c.createElement(l.GridColumn,{width:6},a?c.createElement(f.PredictedContactMap,{data:{couplingScores:r.state[v.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:g,secondaryStructures:r.state[v.VIZ_TYPE.CONTACT_MAP].secondaryStructures},isDataLoading:r.state[v.VIZ_TYPE.CONTACT_MAP].isLoading,style:i({},n,{width:400})}):c.createElement(d.ContactMap,{data:{couplingScores:r.state[v.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:g,secondaryStructures:r.state[v.VIZ_TYPE.CONTACT_MAP].secondaryStructures},isDataLoading:r.state[v.VIZ_TYPE.CONTACT_MAP].isLoading,style:i({},n,{width:400})}))),c.createElement(l.GridRow,{columns:4,centered:!0,textAlign:"center",verticalAlign:"top"},c.createElement(l.GridColumn,null,r.renderPDBUploadForm()),c.createElement(l.GridColumn,null,r.renderCouplingScoresUploadForm()),u&&c.createElement(l.GridColumn,null,r.renderResidueMappingUploadForm()),c.createElement(l.GridColumn,null,r.renderClearAllButton(e))))}))))},r.renderErrorMessage=function(e){var t=void 0===e?r.state:e,n=t.errorMsg,o=t.isResidueMappingNeeded;return c.createElement(l.Message,{warning:!0},o&&r.state.pdbData?c.createElement("div",null,c.createElement(l.Message.Header,null,"Residue numbering mismatch detected - Please upload a residue mapping file to correct the position numbering differences!"),c.createElement(l.Message.List,null,n),c.createElement(l.Message.Content,null,c.createElement(l.Accordion,{fluid:!0,exclusive:!1,defaultActiveIndex:[],panels:[r.renderSequenceAccordionMessage("PDB",r.state.pdbData.sequence),r.renderSequenceAccordionMessage("Couplings Score",r.state[v.VIZ_TYPE.CONTACT_MAP].couplingScores.sequence)]}))):n)},r.renderSequenceAccordionMessage=function(e,t){return{content:{content:c.createElement(l.TextArea,{style:{width:"90%"},value:t})},key:"panel-"+e,title:{content:e+" ("+t.length+" Amino Acids)"}}},r.renderUploadForm=function(e,t,n,r){return void 0===r&&(r=!1),c.createElement(l.GridColumn,null,c.createElement(l.Label,{as:"label",basic:!0,htmlFor:t},c.createElement(l.Button,{disabled:r,icon:"upload",label:{basic:!0,content:n},labelPosition:"right"}),c.createElement("input",{disabled:r,id:t,onChange:e,hidden:!0,type:"file",required:!0,multiple:!1})))},r.renderUploadLabel=function(e){return e?c.createElement(l.GridColumn,{verticalAlign:"middle",textAlign:"justified"},c.createElement(l.Label,null,e)):null},r.renderCouplingScoresUploadForm=function(e){var t=void 0===e?r.state:e,n=t.couplingScores,o=t.filenames;return c.createElement(l.GridRow,null,r.renderUploadLabel(o.couplings),r.renderUploadForm(r.onCouplingScoreUpload,"coupling-score","Coupling Scores",n.length>0))},r.renderPDBUploadForm=function(e){var t=void 0===e?r.state:e,n=t.filenames,o=t.pdbData;return c.createElement(l.GridRow,null,r.renderUploadLabel(n.pdb),r.renderUploadForm(r.onPDBUpload,"pdb","PDB",void 0!==o))},r.renderResidueMappingUploadForm=function(e){var t=(void 0===e?r.state:e).filenames;return c.createElement(l.GridRow,{verticalAlign:"middle",columns:1,centered:!0},r.renderUploadLabel(t.residue_mapper),r.renderUploadForm(r.onResidueMappingUpload,"residue-mapping","Residue Mapping"))},r.renderClearAllButton=function(e){return c.createElement(l.GridRow,{verticalAlign:"middle",columns:1,centered:!0},c.createElement(l.GridColumn,null,c.createElement(l.Label,{as:"label",basic:!0,htmlFor:"clear-data"},c.createElement(l.Button,{icon:"trash",label:{basic:!0,content:"Clear Data"},labelPosition:"right",onClick:r.onClearAll(e)}))))},r.onClearAll=function(e){return function(){return a(r,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.setState(t.initialState)];case 1:return n.sent(),e.clearAllResidues(),[4,this.forceUpdate()];case 2:return n.sent(),[2]}})})}},r.onCouplingScoreUpload=function(e){return a(r,void 0,void 0,function(){var t,n,r,o,a,c,u,l,d,p,f,h;return s(this,function(s){switch(s.label){case 0:if(e.persist(),r=this.state,o=r.measuredProximity,a=r.pdbData,c=e.target.files,null===(u=c?c.item(0):null))return[3,6];if(!u.name.endsWith(".csv"))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),this.setState(((t={})[v.VIZ_TYPE.CONTACT_MAP]=i({},this.state[v.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,_.readFileAsText(u)];case 2:return l=s.sent(),d=C.getCouplingScoresData(l,this.state.residueMapping),p=a?a.getResidueNumberingMismatches(d):[],f=p.length>0,this.setState(((n={})[v.VIZ_TYPE.CONTACT_MAP]={couplingScores:a?a.amendPDBWithCouplingScores(d.rankedContacts,o):d,isLoading:!1,pdbData:this.state.pdbData,secondaryStructures:[]},n.arePredictionsAvailable=!0,n.couplingScores=l,n.errorMsg="",n.filenames=i({},this.state.filenames,{couplings:u.name}),n.isResidueMappingNeeded=f,n)),[3,4];case 3:return h=s.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Coupling Score file '"+u.name+"' - Make sure the file ends in '.csv'!"}),s.label=6;case 6:return e.target.value="",[2]}})})},r.onPDBUpload=function(e){return a(r,void 0,void 0,function(){var t,n,r,o,a,c,u;return s(this,function(s){switch(s.label){case 0:return e.persist(),r=this.state.measuredProximity,o=e.target.files,null===(a=o?o.item(0):null)?[3,3]:a.name.endsWith(".pdb")?(this.setState(((t={})[v.VIZ_TYPE.CONTACT_MAP]=i({},this.state[v.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t[v.VIZ_TYPE.NGL]=i({},this.state[v.VIZ_TYPE.NGL],{isLoading:!0}),t)),[4,g.ChellPDB.createPDB(a)]):[3,2];case 1:return c=s.sent(),u=c.amendPDBWithCouplingScores(this.state[v.VIZ_TYPE.CONTACT_MAP].couplingScores.rankedContacts,r),this.setState(((n={})[v.VIZ_TYPE.CONTACT_MAP]={couplingScores:u,isLoading:!1,pdbData:c,secondaryStructures:c.secondaryStructureSections},n[v.VIZ_TYPE.NGL]={isLoading:!1,pdbData:c.nglStructure},n.errorMsg="",n.filenames=i({},this.state.filenames,{pdb:a.name}),n.pdbData=c,n)),[3,3];case 2:this.setState({errorMsg:"Unable to load PDB file '"+a.name+"' - Make sure the file ends in '.pdb'!"}),s.label=3;case 3:return e.target.value="",[2]}})})},r.onMeasuredProximityChange=function(){return function(e){r.setState({measuredProximity:Object.values(v.CONTACT_DISTANCE_PROXIMITY)[e]})}},r.onResidueMappingUpload=function(e){return a(r,void 0,void 0,function(){var t,n,r,o,a,c,u,l,d,p,f,h;return s(this,function(s){switch(s.label){case 0:if(e.persist(),r=this.state,o=r.measuredProximity,a=r.pdbData,c=e.target.files,u=c?c.item(0):null,l=["csv","indextable","indextableplus"],null===u)return[3,6];if(!l.reduce(function(e,t){return e||u.name.endsWith("."+t)},!1))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),this.setState(((t={})[v.VIZ_TYPE.CONTACT_MAP]=i({},this.state[v.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,_.readFileAsText(u)];case 2:return d=s.sent(),p=S.generateResidueMapping(d),f=C.getCouplingScoresData(this.state.couplingScores,p),this.setState(((n={})[v.VIZ_TYPE.CONTACT_MAP]={couplingScores:a?a.amendPDBWithCouplingScores(f.rankedContacts,o):f,isLoading:!1,secondaryStructures:[]},n.errorMsg="",n.filenames=i({},this.state.filenames,{residue_mapper:u.name}),n.residueMapping=p,n)),[3,4];case 3:return h=s.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Residue Mapping file '"+u.name+"' - Make sure the file ends in one of the following: '"+l.join("', '")+"'"}),s.label=6;case 6:return e.target.value="",[2]}})})},r.state=t.initialState,r}return o(t,e),t.prototype.componentDidUpdate=function(e,t){var n=this.state.pdbData,r=this.state[v.VIZ_TYPE.CONTACT_MAP].couplingScores;if(n&&(r!==t[v.VIZ_TYPE.CONTACT_MAP].couplingScores||n!==t.pdbData)){var o=n.getResidueNumberingMismatches(r);o.length>=1&&this.setState({errorMsg:o.length+" mismatches detected between coupling scores and PDB!",isResidueMappingNeeded:!0})}},t.prototype.render=function(e){var t=(void 0===e?this.props:e).style;return c.createElement("div",{id:"ChellVizApp",style:i({},t,{height:"1000px"})},this.renderCouplingComponents())},t.defaultProps={style:{backgroundColor:"#ffffff"}},t.initialState=((r={})[v.VIZ_TYPE.CONTACT_MAP]={couplingScores:new m.CouplingContainer,isLoading:!1,pdbData:void 0,secondaryStructures:[]},r[v.VIZ_TYPE.NGL]={isLoading:!1,pdbData:void 0},r.arePredictionsAvailable=!1,r.couplingScores="",r.errorMsg="",r.filenames={},r.isResidueMappingNeeded=!1,r.measuredProximity=v.CONTACT_DISTANCE_PROXIMITY.CLOSEST,r.pdbData=void 0,r.residueMapping=[],r),t}(c.Component);u.render(c.createElement(x,null),document.getElementById("example-root"))},"./src/component/ContactMap.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n("./node_modules/react/index.js"),u=n("./node_modules/semantic-ui-react/dist/es/index.js"),l=n("./src/context/ResidueContext.tsx"),d=n("./src/context/SecondaryStructureContext.tsx"),p=n("./src/data/ChellConfig.ts"),f=n("./src/data/CouplingContainer.ts"),h=n("./src/component/chart/ContactMapChart.tsx");t.initialContactMapState={pointsToPlot:new Array,showConfiguration:!1};var y=function(e){function n(n){var r=e.call(this,n)||this;return r.state=t.initialContactMapState,r.onNodeSizeChange=function(e){return function(t){var n=r.state.pointsToPlot;r.setState({pointsToPlot:a(n.slice(0,e),[o({},n[e],{nodeSize:t})],n.slice(e+1))})}},r.generateNodeSizeSliderConfigs=function(e,t){return e.map(function(e,n){return{id:"node-size-slider-"+n,name:"Node size for "+e.name,onChange:r.onNodeSizeChange(n),style:t,type:p.CONFIGURATION_COMPONENT_TYPE.SLIDER,values:{current:e.nodeSize,max:20,min:1}}})},r.onMouseEnter=function(e){return function(t){var n,o,i,c;if(t.isAxis()){var u=r.props,l=u.secondaryStructureContext,d=u.data;try{for(var p=s(d.secondaryStructures),f=p.next();!f.done;f=p.next()){var h=f.value;try{for(var y=s(h),v=y.next();!v.done;v=y.next()){var g=v.value;g.contains.apply(g,a(t.selectedPoints))&&l.toggleSecondaryStructure(g)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(c=y.return)&&c.call(y)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}else e(t.selectedPoints)}},r.onMouseLeave=function(e){return function(t){var n,o,i,c;if(t.isAxis()){var u=r.props,l=u.data,d=u.secondaryStructureContext;try{for(var p=s(l.secondaryStructures),f=p.next();!f.done;f=p.next()){var h=f.value;try{for(var y=s(h),v=y.next();!v.done;v=y.next()){var g=v.value;g.contains.apply(g,a(t.selectedPoints))&&(d.selectedSecondaryStructures.includes(g)||d.removeSecondaryStructure(g))}}catch(e){i={error:e}}finally{try{v&&!v.done&&(c=y.return)&&c.call(y)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}else e&&e(t.selectedPoints)}},r.onMouseClick=function(e){return function(t){var n,o,i,c;if(t.isAxis()){var u=r.props,l=u.data,d=u.secondaryStructureContext;try{for(var p=s(l.secondaryStructures),f=p.next();!f.done;f=p.next()){var h=f.value;try{for(var y=s(h),v=y.next();!v.done;v=y.next()){var g=v.value;g.contains.apply(g,a(t.selectedPoints))&&(d.selectedSecondaryStructures.includes(g)?d.removeSecondaryStructure(g):d.addSecondaryStructure(g))}}catch(e){i={error:e}}finally{try{v&&!v.done&&(c=y.return)&&c.call(y)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}else e(t.selectedPoints)}},r.onMouseSelect=function(e){return function(t){e&&e(t.selectedPoints.map(function(e){return e}))}},r}return r(n,e),n.prototype.componentDidMount=function(){this.setupPointsToPlot(this.props.data.couplingScores)},n.prototype.componentDidUpdate=function(e){var t=this.props,n=t.data,r=t.residueContext;n===e.data&&r.lockedResiduePairs===e.residueContext.lockedResiduePairs||this.setupPointsToPlot(n.couplingScores,r.lockedResiduePairs)},n.prototype.render=function(){var e=this.props,t=e.configurations,n=e.isDataLoading,r=e.style,i=e.width,s=this.state.pointsToPlot,l={width:.9*i};return c.createElement("div",{id:"ContactMapComponent",style:o({},r)},c.createElement(u.Dimmer.Dimmable,{dimmed:!0},c.createElement(u.Dimmer,{active:n},c.createElement(u.Loader,null)),this.renderContactMapChart(s,a(t,this.generateNodeSizeSliderConfigs(s,l)))))},n.prototype.setupPointsToPlot=function(e,t){void 0===t&&(t=new Map);var n=this.props,r=n.formattedPoints,i=n.observedColor,s=n.highlightColor,c=this.state.pointsToPlot,u="Known Structure Contact",l="Selected Res. Pairs",d=c.findIndex(function(e){return e.name===u}),p=c.findIndex(function(e){return e.name===l}),f=new(Array.bind.apply(Array,a([void 0,h.generateChartDataEntry("x+y",{start:i,end:"rgb(100,177,200)"},u,"(from PDB structure)",d>=0?c[d].nodeSize:4,e.getObservedContacts())],r)));t.size>0&&f.push(h.generateChartDataEntry("none",s,l,"",p>=0?c[p].nodeSize:6,Array.from(t.keys()).filter(function(e){return 2===t.get(e).length}).map(function(e){return{i:t.get(e)[0],j:t.get(e)[1],dist:0}}),{marker:{color:new Array(2*t.size).fill(s),line:{color:s,width:3},symbol:"circle-open"}})),this.setState(o({},this.state,{pointsToPlot:a(f)}))},n.prototype.renderContactMapChart=function(e,t){var n=this.props,r=n.data,o=n.onBoxSelection,i=n.residueContext,a=n.secondaryStructureContext;return c.createElement(h.default,{candidateResidues:i.candidateResidues,configurations:t,contactData:e,onClickCallback:this.onMouseClick(i.toggleLockedResiduePair),onHoverCallback:this.onMouseEnter(i.addHoveredResidues),onSelectedCallback:this.onMouseSelect(o),onUnHoverCallback:this.onMouseLeave(i.removeHoveredResidues),range:r.couplingScores.residueIndexRange.max+20,secondaryStructures:r.pdbData?r.pdbData.secondaryStructureSections:[],selectedSecondaryStructures:[a.selectedSecondaryStructures]})},n.defaultProps={configurations:new Array,data:{couplingScores:new f.CouplingContainer,secondaryStructures:new Array},enableSliders:!0,formattedPoints:new Array,height:400,highlightColor:"#ff8800",isDataLoading:!1,observedColor:"#0000ff",residueContext:o({},l.initialResidueContext),secondaryStructureContext:o({},d.initialSecondaryStructureContext),width:400},n}(c.Component);t.ContactMapClass=y;var v=function(e){return c.createElement(d.default.Consumer,null,function(t){return c.createElement(l.ResidueContextWrapper.Consumer,null,function(n){return c.createElement(y,o({},e,{residueContext:o({},n),secondaryStructureContext:o({},t)}))})})};t.ContactMap=v,t.default=v},"./src/component/NGLComponent.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n("./node_modules/lodash/lodash.js"),u=n("./node_modules/ngl/dist/ngl.esm.js"),l=n("./node_modules/react/index.js"),d=n("./node_modules/semantic-ui-react/dist/es/index.js"),p=n("./src/context/CouplingContext.tsx"),f=n("./src/context/ResidueContext.tsx"),h=n("./src/context/SecondaryStructureContext.tsx"),y=n("./src/data/chell-data.ts"),v=n("./src/data/ChellConfig.ts"),g=n("./src/data/ChellPDB.ts"),m=n("./src/helper/NGLHelper.ts"),C=n("./src/component/widget/SettingsPanel.tsx");t.initialNGLState={activeRepresentations:new Array,pdbData:void 0,stage:void 0,structureComponent:void 0};var _=function(e){function n(n){var r=e.call(this,n)||this;return r.state=t.initialNGLState,r.canvas=null,r.onClick=function(e){var t=r.props.residueContext,n=r.state.structureComponent;if(r.canvas&&n)if(e){if(e.picker&&"distance"===e.picker.type){var o=[e.distance.atom1.resno,e.distance.atom2.resno];t.removeLockedResiduePair(o)}else if(e.atom||e.closestBondAtom){var i=e.atom||e.closestBondAtom;t.candidateResidues.length>=1?(t.addLockedResiduePair(a(t.candidateResidues,[i.resno])),t.removeCandidateResidues()):t.addCandidateResidues([i.resno])}}else t.candidateResidues.length>=1&&t.hoveredResidues.length>=1?t.hoveredResidues.forEach(function(e){var r=n.stage.mouseObserver,o=r.down,i=r.canvasPosition,s=r.position;!function(e,t){return void 0===t&&(t=100),e.filter(function(e){return e<t}).length>=1}([o,i,r.prevClickCP,r.prevPosition,s].map(function(t){return function(t,r){for(var o=Number.MAX_SAFE_INTEGER,i=t.atomOffset[e],a=t.atomCount[e],s=0;s<a;++s){var c=n.structure.getAtomProxy(i+s),u=n.stage.viewerControls.getPositionOnCanvas(c.positionToVector3());o=Math.min(o,r.distanceTo(u))}return o}(n.structure.residueStore,t)}))?t.removeNonLockedResidues():(t.addLockedResiduePair(a(t.candidateResidues,[e])),t.removeCandidateResidues())}):t.removeNonLockedResidues()},r.onCanvasLeave=function(){r.props.residueContext.removeNonLockedResidues()},r.onResizeHandler=function(e){var t=r.props.onResize,n=r.state.stage;n&&n.handleResize(),t&&t(e)},r.onKeyDown=function(e){27!==e.which&&27!==e.keyCode||r.props.residueContext.removeNonLockedResidues()},r}return r(n,e),n.prototype.componentDidMount=function(e){var t=(void 0===e?this.props:e).backgroundColor;if(this.canvas){var n=new u.Stage(this.canvas,{backgroundColor:t}),r=this.props.data;this.initData(n,r),this.setState({stage:n})}window.addEventListener("resize",this.onResizeHandler,!1)},n.prototype.componentWillUnmount=function(){var e=this.state.stage;e&&(e.dispose(),this.setState({activeRepresentations:[],stage:void 0})),window.removeEventListener("resize",this.onResizeHandler)},n.prototype.componentDidUpdate=function(e,t){var n,r,o=this.props.data,i=this.state,a=i.stage,c=i.structureComponent;if(a&&o!==e.data&&this.initData(a,o),a&&o&&c){var u=this.props,l=u.residueContext,d=u.secondaryStructureContext;if(l!==e.residueContext||d!==e.secondaryStructureContext){try{for(var p=s(this.state.activeRepresentations),f=p.next();!f.done;f=p.next()){var h=f.value;c.removeRepresentation(h)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}this.setState({activeRepresentations:this.deriveActiveRepresentations(c)})}a.viewer.requestRender()}},n.prototype.render=function(){var e=this,t=this.props,n=t.height,r=t.isDataLoading,i=t.residueContext,a=t.style,s=t.width;return l.createElement("div",{className:"NGLComponent",style:o({},a)},l.createElement(d.Dimmer.Dimmable,{dimmed:!0},l.createElement(d.Dimmer,{active:r},l.createElement(d.Loader,null)),l.createElement(C.SettingsPanel,{configurations:[{name:"Remove All Locked Distance Pairs",onClick:i.removeAllLockedResiduePairs,type:v.CONFIGURATION_COMPONENT_TYPE.BUTTON},{current:y.CONTACT_DISTANCE_PROXIMITY.CLOSEST,name:"Measuring Proximity",onChange:function(){},options:Object.values(y.CONTACT_DISTANCE_PROXIMITY),type:v.CONFIGURATION_COMPONENT_TYPE.RADIO}]},l.createElement("div",{className:"NGLCanvas",ref:function(t){return e.canvas=t},style:{height:n,width:s},onMouseLeave:this.onCanvasLeave,onKeyDown:this.onKeyDown}))))},n.prototype.initData=function(e,t){e.removeAllComponents(),t?(this.addStructureToStage(c.cloneDeep(t),e),this.setState({pdbData:g.ChellPDB.createPDBFromNGLData(t)})):this.setState({pdbData:void 0,structureComponent:void 0})},n.prototype.deriveActiveRepresentations=function(e){var t=this.props,n=t.residueContext,r=t.secondaryStructureContext;return a(this.highlightCandidateResidues(e,a(n.candidateResidues,n.hoveredResidues).filter(function(e,t,n){return n.indexOf(e)===t}).sort()),this.highlightLockedDistancePairs(e,n.lockedResiduePairs),this.highlightSecondaryStructures(e,a(r.selectedSecondaryStructures,r.temporarySecondaryStructures)))},n.prototype.addStructureToStage=function(e,t){var n=this,r=t.addComponentFromObject(e);r.stage.mouseControls.add("hoverPick",function(e,t){return n.onHover(e,t)}),t.defaultFileRepresentation(r),t.signals.clicked.add(this.onClick),t.viewer.requestRender(),this.setState({activeRepresentations:this.deriveActiveRepresentations(r),stage:t,structureComponent:r})},n.prototype.onHover=function(e,t){var n=this.props.residueContext;if(this.state.structureComponent)if(t&&(t.atom||t.closestBondAtom)){var r=t.atom||t.closestBondAtom;n.addHoveredResidues([r.resno])}else 0===n.candidateResidues.length&&0!==n.hoveredResidues.length&&n.removeHoveredResidues()},n.prototype.getDistanceRepForResidues=function(e,t,n){if(this.props.measuredProximity===y.CONTACT_DISTANCE_PROXIMITY.C_ALPHA)return m.createDistanceRepresentation(e,t.join(".CA, ")+".CA");var r=n.getMinDistBetweenResidues(t[0],t[1]),o=r.atomIndexI,i=r.atomIndexJ;return m.createDistanceRepresentation(e,[o,i])},n.prototype.highlightCandidateResidues=function(e,t){var n=new Array,r=this.state.pdbData;return t.length>=1&&(n.push(m.createBallStickRepresentation(e,t)),t.length>=2&&r&&n.push(this.getDistanceRepForResidues(e,t,r))),n},n.prototype.highlightLockedDistancePairs=function(e,t){var n=this,r=this.state.pdbData,o=new Array;return t.forEach(function(t){o.push(m.createBallStickRepresentation(e,t)),t.length>=2&&r&&o.push(n.getDistanceRepForResidues(e,t,r))}),o},n.prototype.highlightSecondaryStructures=function(e,t){var n,r,o=new Array;try{for(var i=s(t),a=i.next();!a.done;a=i.next()){var c=a.value;o.push(m.createSecStructRepresentation(e,c))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},n.defaultProps={backgroundColor:"#ffffff",couplingContext:o({},p.initialCouplingContext),data:void 0,height:400,isDataLoading:!1,measuredProximity:y.CONTACT_DISTANCE_PROXIMITY.C_ALPHA,residueContext:o({},f.initialResidueContext),secondaryStructureContext:o({},h.initialSecondaryStructureContext),width:400},n}(l.Component);t.NGLComponentClass=_;var S=function(e){return p.withCouplingContext(_)(o({},e))};t.NGLComponent=S,t.default=S},"./src/component/PredictedContactMap.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n("./node_modules/react/index.js"),s=n("./src/data/ChellConfig.ts"),c=n("./src/data/CouplingContainer.ts"),u=n("./src/component/chart/ContactMapChart.tsx"),l=n("./src/component/ContactMap.tsx");t.initialPredictedContactMapState={linearDistFilter:5,numPredictionsToShow:-1,pointsToPlot:[]};var d=function(e){function n(n){var r=e.call(this,n)||this;return r.state=t.initialPredictedContactMapState,r.onLinearDistFilterChange=function(){return function(e){r.setState({linearDistFilter:e})}},r.onNumPredictionsToShowChange=function(){return function(e){r.setState({numPredictionsToShow:e})}},r.getContactMapConfigs=function(){return[{name:"Linear Distance Filter (|i - j|)",onChange:r.onLinearDistFilterChange(),type:s.CONFIGURATION_COMPONENT_TYPE.SLIDER,values:{current:r.state.linearDistFilter,max:10,min:1}},{name:"Top N Predictions to Show",onChange:r.onNumPredictionsToShowChange(),type:s.CONFIGURATION_COMPONENT_TYPE.SLIDER,values:{current:r.state.numPredictionsToShow,max:r.props.data.couplingScores.chainLength,min:1}}]},r}return r(n,e),n.prototype.componentDidMount=function(){this.setupData(!0)},n.prototype.componentDidUpdate=function(e,t){var n=this.props.data,r=this.state,o=r.linearDistFilter,i=r.numPredictionsToShow;(n.couplingScores!==e.data.couplingScores||o!==t.linearDistFilter||i!==t.numPredictionsToShow)&&this.setupData(n.couplingScores!==e.data.couplingScores)},n.prototype.render=function(){var e=this.props,t=e.data,n=e.style,r=i(e,["data","style"]),s=this.state.pointsToPlot;return a.createElement("div",{id:"PredictedContactMapComponent",style:o({},n)},a.createElement(l.ContactMap,o({configurations:this.getContactMapConfigs(),data:{couplingScores:t.couplingScores,pdbData:t.pdbData,secondaryStructures:t.pdbData?t.pdbData.secondaryStructureSections:[]},formattedPoints:s},r)))},n.prototype.setupData=function(e){var t=this.props,n=t.correctColor,r=t.data,o=t.incorrectColor,i=this.state,a=i.linearDistFilter,s=i.numPredictionsToShow,l=r.pdbData?r.pdbData.contactInformation:new c.CouplingContainer(r.couplingScores.rankedContacts),d=l.chainLength,p=l.getPredictedContacts(s,a),f=(p.correct.length/p.predicted.length*100).toFixed(2),h=[u.generateChartDataEntry("x+y",o,"Predicted Contact","(N="+s+", L="+d+")",4,p.predicted),u.generateChartDataEntry("x+y",n,"Correct Prediction","(N="+p.correct.length+", "+f+"%)",6,p.correct)];this.setState({numPredictionsToShow:e?Math.floor(d/2):s,pointsToPlot:h})},n.defaultProps={correctColor:"#ff0000",data:{couplingScores:new c.CouplingContainer,secondaryStructures:new Array},height:400,incorrectColor:"#000000",isDataLoading:!1,width:400},n}(a.Component);t.PredictedContactMap=d,t.default=d},"./src/component/chart/AuxiliaryAxis.ts":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,n,o,i,a){void 0===t&&(t=2),void 0===n&&(n="black"),void 0===a&&(a=function(){return!1});var s=this;this.sections=e,this.axisIndex=t,this.defaultColor=n,this.colorMap=o,this.dataTransformFn=i,this.filterFn=a,this.axes=new Map,this.generateXAxisSegment=function(e){return r({},s.auxiliaryAxisDefaults(e),{orientation:"h",xaxis:"x",yaxis:"y"+s.axisIndex})},this.generateYAxisSegment=function(e){return r({},s.auxiliaryAxisDefaults(e),{orientation:"v",xaxis:"x"+s.axisIndex,yaxis:"y"})},this.auxiliaryAxisDefaults=function(e){return{connectgaps:!1,hoverinfo:"name",line:{color:s.colorMap&&s.colorMap[e]?s.colorMap[e]:s.defaultColor,shape:"spline",smoothing:1.3,width:1.5},marker:{symbol:[]},mode:"lines",name:e,showlegend:!1,type:"scatter",x:[],y:[]}},this.derivePointsInAxis=function(e){for(var t={main:[e.start],opposite:[null]},n=e.start;n<=e.end;++n){var r=s.dataTransformFn&&s.dataTransformFn[e.label]?s.dataTransformFn[e.label](e,n):{main:n,opposite:-1};t.main.push(r.main),t.opposite.push(r.opposite)}return t.main.push(e.end),t.opposite.push(null),t},this.setupAuxiliaryAxis()}return Object.defineProperty(e.prototype,"axis",{get:function(){return this.axes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xAxes",{get:function(){var e=new Array;return this.axes.forEach(function(t){e.push(t.x)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yAxes",{get:function(){var e=new Array;return this.axes.forEach(function(t){e.push(t.y)}),e},enumerable:!0,configurable:!0}),e.prototype.setupAuxiliaryAxis=function(){var e,t,n,r,i,s;try{for(var c=o(this.sections),u=c.next();!u.done;u=c.next()){var l=u.value;if(!this.filterFn(l)){var d=l.label;this.axes.has(d)||this.axes.set(d,{x:this.generateXAxisSegment(d),y:this.generateYAxisSegment(d)});var p=this.derivePointsInAxis(l);(n=this.axes.get(d).x.x).push.apply(n,a(p.main)),(r=this.axes.get(d).x.y).push.apply(r,a(p.opposite)),(i=this.axes.get(d).y.y).push.apply(i,a(p.main)),(s=this.axes.get(d).y.x).push.apply(s,a(p.opposite))}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}},e}();t.AuxiliaryAxis=s,t.default=s},"./src/component/chart/ContactMapChart.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var c=n("./node_modules/react/index.js"),u=n("./src/helper/PlotlyHelper.ts"),l=n("./src/component/widget/SettingsPanel.tsx"),d=n("./src/component/chart/AuxiliaryAxis.ts"),p=n("./src/component/chart/PlotlyChart.tsx"),f=n("./src/component/chart/SecondaryStructureAxis.ts");t.generateChartDataEntry=function(e,t,n,r,i,a,s){return void 0===s&&(s={}),o({hoverinfo:e,marker:"string"==typeof t?{color:new Array(2*a.length).fill(t)}:{colorscale:[[0,"rgb(12,50,102)"],[.1,"rgb(17,83,150)"],[.2,"rgb(40,114,175)"],[.3,"rgb(71,147,193)"],[.4,"rgb(111,175,209)"],[.5,"rgb(160,202,222)"],[.6,"rgb(200,219,237)"],[.7,"rgb(224,235,246)"],[.8,"rgb(247,251,255)"],[.9,"rgb(249,253,255)"],[1,"rgb(255,255,255)"]]},mode:"lines+markers",name:n,nodeSize:i,points:a,subtitle:r},s)};var h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={numLegends:0,plotlyData:[]},n}return r(t,e),t.prototype.componentDidMount=function(){this.setupData()},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.contactData,r=t.secondaryStructures,o=t.selectedSecondaryStructures;e.contactData===n&&e.secondaryStructures===r&&e.selectedSecondaryStructures===o||this.setupData()},t.prototype.render=function(){var e=this.props,t=e.configurations,n=(e.contactData,e.heightModifier),r=e.legendModifiers,a=e.marginModifiers,s=e.range,u=i(e,["configurations","contactData","heightModifier","legendModifiers","marginModifiers","range"]),d=this.state.plotlyData;return c.createElement(l.SettingsPanel,{configurations:t},c.createElement(p.PlotlyChart,o({data:d,layout:{height:p.defaultPlotlyLayout.height+p.defaultPlotlyLayout.height*n,legend:{orientation:"h",y:r.y,yanchor:"bottom"},margin:{b:a.b,l:a.l},showlegend:!0,xaxis:{autorange:!1,nticks:10,range:[1,s],showline:!0,tickmode:"auto",title:"Residue #"},yaxis:{autorange:!1,nticks:10,range:[1,s].reverse(),showline:!0,tickmode:"auto",title:"Residue #"}}},u)))},t.prototype.setupData=function(){var e=this.props,t=e.contactData,n=e.dataTransformFn,r=e.secondaryStructures,o=e.selectedSecondaryStructures,i=s(t.map(function(e){return n(e,!0)}));r.forEach(function(e,t){var n=new f.SecondaryStructureAxis(e,5,t+2);i.push.apply(i,s(n.xAxes,n.yAxes))}),o.forEach(function(e,t){var n=new d.AuxiliaryAxis(e,t+2,"orange");i.push.apply(i,s(n.xAxes,n.yAxes))}),this.setState({numLegends:new Set(i.filter(function(e){return!1!==e.showlegend&&void 0!==e.name}).map(function(e){return e.name})).size,plotlyData:i})},t.defaultProps={candidateResidues:new Array,configurations:new Array,dataTransformFn:u.generateScatterGLData,heightModifier:.3,legendModifiers:{y:-.4},marginModifiers:{b:75,l:65},range:100,secondaryStructures:[],selectedSecondaryStructures:[]},t}(c.Component);t.default=h},"./src/component/chart/PlotlyChart.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n("./node_modules/immutable/dist/immutable.js"),d=n("./node_modules/lodash/lodash.js"),p=n("./node_modules/plotly.js-gl2d-dist/plotly-gl2d.js"),f=n("./node_modules/react/index.js"),h=n("./node_modules/semantic-ui-react/dist/es/index.js"),y=n("./src/data/chell-data.ts"),v=n("./src/data/event/ChellChartEvent.ts");!function(e){e.bar="bar",e.pointcloud="pointcloud",e.scatter="scatter",e.scattergl="scattergl",e.scatter3d="scatter3d"}(t.PLOTLY_CHART_TYPE||(t.PLOTLY_CHART_TYPE={})),t.defaultPlotlyConfig={displayModeBar:!1,doubleClick:"reset",scrollZoom:!0,showAxisDragHandles:!1,staticPlot:!1},t.defaultPlotlyLayout={autosize:!0,dragmode:"zoom",height:400,hovermode:"closest",legend:{},margin:{b:10,l:40,r:10,t:10},showlegend:!1,title:"",width:400};var g=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.plotlyCanvas=null,n.isDoubleClickInProgress=!1,n.canvasRef=null,n.plotlyFormattedData=[],n.resize=function(){n.plotlyCanvas&&p.Plots.resize(n.plotlyCanvas)},n.draw=function(){return i(n,void 0,void 0,function(){var e,t,n,r,o,i;return a(this,function(a){switch(a.label){case 0:return e=this.props,t=e.config,n=e.layout,this.plotlyCanvas&&this.canvasRef?(r=this.getMergedLayout(n,this.plotlyFormattedData),o=this.getMergedConfig(t),i=this,[4,p.react(this.canvasRef,this.plotlyFormattedData,r,o)]):[3,2];case 1:i.plotlyCanvas=a.sent(),a.label=2;case 2:return[2]}})})},n.deriveChartPiece=function(e,t,n){if(n){var r=n.xaxis&&"x"!==n.xaxis,o=n.yaxis&&"y"!==n.yaxis;if(r||o)return{chartPiece:y.CHELL_CHART_PIECE.AXIS,selectedPoints:r?[t]:[e]}}return{chartPiece:y.CHELL_CHART_PIECE.POINT,selectedPoints:[e,t]}},n.generateExtraPlotlyAxis=function(e){return Array.from(e.values()).filter(function(e){return e.length>=2}).map(function(e){var t,n=e.substr(0,1),r=Number.parseInt(e.substr(1),10);return(t={})[n+"axis"+r]={autosize:!1,domain:[1-.05*(r-1),1-.05*(r-2)],dragmode:"select",fixedrange:!0,margin:{autoexpand:!1},visible:!1},t}).reduce(function(e,t){return o({},e,t)},{})},n.getMergedConfig=function(e){return void 0===e&&(e={}),o({},l.fromJS(o({},t.defaultPlotlyConfig)).mergeDeep(l.fromJS(o({},e))).toJS())},n.getMergedLayout=function(e,r){void 0===e&&(e={}),void 0===r&&(r=[]);var i=o({},l.fromJS(o({},t.defaultPlotlyLayout,n.deriveAxisParams(r))).mergeDeep(l.fromJS(o({},e))).toJS());return n.savedAxisZoom&&i.xaxis&&i.yaxis&&(i.xaxis.range=n.savedAxisZoom.xaxis.range,i.yaxis.range=n.savedAxisZoom.yaxis.range),i},n.onAfterPlot=function(){var e=n.props.onAfterPlotCallback;e&&e(new v.default(y.CHELL_CHART_EVENT_TYPE.AFTER_PLOT))},n.onClick=function(e){if(!n.isDoubleClickInProgress){var t=n.props.onClickCallback;if(e.points&&e.points.length>0&&t){var r=e.points[0].x?e.points[0].x:e.points[0].data.x[0],o=e.points[0].y?e.points[0].y:e.points[0].data.y[0],i=n.deriveChartPiece(r,o,e.points[0].data),a=i.chartPiece,s=i.selectedPoints;t(new v.default(y.CHELL_CHART_EVENT_TYPE.CLICK,a,s))}}},n.onDoubleClick=function(){n.isDoubleClickInProgress=!0;var e=n.props.onDoubleClickCallback;e&&e(new v.default(y.CHELL_CHART_EVENT_TYPE.DOUBLE_CLICK))},n.onHover=function(e){var t=n.props.onHoverCallback;if(e.points&&e.points[0]&&t){var r=e.points[0].x?e.points[0].x:e.points[0].data.x[0],o=e.points[0].y?e.points[0].y:e.points[0].data.y[0],i=n.deriveChartPiece(r,o,e.points[0].data),a=i.chartPiece,s=i.selectedPoints;t(new v.default(y.CHELL_CHART_EVENT_TYPE.HOVER,a,s))}},n.onRelayout=function(e){n.isDoubleClickInProgress=!1;var t=["xaxis.range[0]","xaxis.range[1]","yaxis.range[0]","yaxis.range[1]"],r=void 0!==e&&!0===t.reduce(function(t,n){return t&&void 0!==e[n]},!0);n.savedAxisZoom=r?{xaxis:{autorange:!1,range:[e[t[0]],e[t[1]]]},yaxis:{autorange:!1,range:[e[t[2]],e[t[3]]]}}:void 0;var o=n.props.onRelayoutCallback;o&&o(new v.default(y.CHELL_CHART_EVENT_TYPE.RELAYOUT))},n.onSelect=function(e){return i(n,void 0,void 0,function(){var t,n,r;return a(this,function(o){switch(o.label){case 0:return t=this.props.onSelectedCallback,e&&t&&(n=new Array,e.points.length>=1?n=e.points.reduce(function(e,t){return e.push.apply(e,c([t.x,t.y])),e},n):e.range&&n.push(e.range.x[0],e.range.y[0],e.range.x[1],e.range.y[1]),r=(n.length>0?this.deriveChartPiece(n[0],n[1]):{chartPiece:y.CHELL_CHART_PIECE.POINT}).chartPiece,t(new v.default(y.CHELL_CHART_EVENT_TYPE.SELECTION,r,n))),[4,this.draw()];case 1:return o.sent(),[2]}})})},n.onUnHover=function(e){var t=n.props.onUnHoverCallback;if(e&&t){var r=e.points[0],o=r.data,i=r.x,a=r.y,s=n.deriveChartPiece(i,a,o),c=s.chartPiece,u=s.selectedPoints;t(new v.default(y.CHELL_CHART_EVENT_TYPE.UNHOVER,c,u))}},n}return r(n,e),n.prototype.attachListeners=function(){this.plotlyCanvas&&(this.plotlyCanvas.on("plotly_afterplot",this.onAfterPlot),this.plotlyCanvas.on("plotly_click",this.onClick),this.plotlyCanvas.on("plotly_doubleclick",this.onDoubleClick),this.plotlyCanvas.on("plotly_hover",this.onHover),this.plotlyCanvas.on("plotly_relayout",this.onRelayout),this.plotlyCanvas.on("plotly_selected",this.onSelect),this.plotlyCanvas.on("plotly_unhover",this.onUnHover)),window.removeEventListener("resize",this.resize),window.addEventListener("resize",this.resize)},n.prototype.componentDidUpdate=function(e){var t=this.props,n=t.data,r=t.layout,o=t.config;d.isEqual(n,e.data)&&d.isEqual(r,e.layout)&&d.isEqual(o,e.config)||(this.plotlyFormattedData=d.isEqual(n,e.data)?this.plotlyFormattedData:l.fromJS(n).toJS(),this.draw())},n.prototype.componentDidMount=function(){return i(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return!this.canvasRef||this.plotlyCanvas?[3,2]:(e=this.props.data,this.plotlyFormattedData=l.fromJS(e).toJS(),t=this,[4,p.react(this.canvasRef,this.plotlyFormattedData)]);case 1:t.plotlyCanvas=n.sent(),this.attachListeners(),this.draw(),n.label=2;case 2:return[2]}})})},n.prototype.componentWillUnmount=function(){this.plotlyCanvas&&(p.purge(this.plotlyCanvas),this.plotlyCanvas=null,this.canvasRef=null),window.removeEventListener("resize",this.resize)},n.prototype.render=function(){var e=this,t=this.props.showLoader;return f.createElement("div",null,t&&f.createElement(h.Dimmer,{active:!this.isDataLoaded()},f.createElement(h.Loader,null)),f.createElement("div",{className:"plotly-chart",ref:function(t){return e.canvasRef=t||null},style:{marginBottom:5}}))},n.prototype.deriveAxisParams=function(e){var t,n,r=new Set,i=new Set;try{for(var a=u(e),s=a.next();!s.done;s=a.next()){var c=s.value,l=c.xaxis,d=c.yaxis;l&&r.add(l),d&&i.add(d)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o({},this.generateExtraPlotlyAxis(r),this.generateExtraPlotlyAxis(i),{xaxis:{domain:[0,1-.05*r.size],range:[30],zeroline:!1},yaxis:{domain:[0,1-.05*r.size],range:[30],zeroline:!1}})},n.prototype.isDataLoaded=function(){return this.props.data.length>0||this.plotlyFormattedData.filter(function(e){return e.x&&e.x.length>=1}).length>0},n.defaultProps={config:{},data:[],layout:{},showLoader:!0},n}(f.Component);t.PlotlyChart=g,t.default=g},"./src/component/chart/SecondaryStructureAxis.ts":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(n,r,o,i,a,s,c){void 0===r&&(r=3),void 0===o&&(o=2),void 0===i&&(i="black"),void 0===a&&(a={C:"red",E:"green",H:"blue"}),void 0===s&&(s={C:t.centerSectionPositionFn,E:t.centerSectionPositionFn,H:function(e,t){return{main:t,opposite:Math.sin(t-e.start)}}}),void 0===c&&(c=function(e){return e.length<=r});var u=e.call(this,n,o,i,a,s,c)||this;return u.sections=n,u.minimumRequiredResidues=r,u.axisIndex=o,u.defaultColor=i,u.colorMap=a,u.dataTransformFn=s,u.filterFn=c,u}return r(t,e),t.prototype.setupAuxiliaryAxis=function(){e.prototype.setupAuxiliaryAxis.call(this);var t=this.axes.get("E");if(t&&t.x.x&&t.x.y){for(var n={main:new Array(t.x.x.length).fill("line-ne"),opposite:new Array(t.x.x.length).fill("line-ne")},r=1;r<t.x.x.length-1;++r)null===t.x.y[r+1]&&(n.main[r]="triangle-right",n.opposite[r]="triangle-down");t.x=o({},t.x,this.generateBetaSheetStyle(t.x,n.main)),t.y=o({},t.y,this.generateBetaSheetStyle(t.y,n.opposite))}},t.prototype.generateBetaSheetStyle=function(e,t){return{line:o({},e.line,{width:5}),marker:o({},e.marker,{color:this.colorMap.E,size:10,symbol:t}),mode:"lines+markers"}},t.centerSectionPositionFn=function(e,t){return{main:t,opposite:0}},t}(n("./src/component/chart/AuxiliaryAxis.ts").default);t.SecondaryStructureAxis=i,t.default=i},"./src/component/widget/ChellRadioGroup.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n("./node_modules/react/index.js"),i=n("./node_modules/semantic-ui-react/dist/es/index.js"),a=function(e){function t(t){var n=e.call(this,t)||this;return n.handleChange=function(e){return function(t,r){n.setState({selectedIndex:e}),n.props.onChange&&n.props.onChange(e)}},n.renderOptions=function(e,t,r,a){return t.map(function(t,s){return o.createElement(i.Form.Radio,{checked:n.state.selectedIndex===s,disabled:r,key:e+"-"+t,label:{children:t.toLocaleLowerCase(),style:a},name:t,onChange:n.handleChange(s),value:s})})},n.state={selectedIndex:0},n}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.id,r=e.options,a=e.style,s=e.title;return o.createElement(i.Form,{style:a},o.createElement(i.Form.Field,null,s),o.createElement(i.Form.Group,{widths:"equal"},this.renderOptions(n,r,t,a)))},t.defaultProps={disabled:!1,style:{},title:"How to calculate distance between two residues:"},t}(o.Component);t.ChellRadioGroup=a,t.default=a},"./src/component/widget/ChellSlider.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n("./node_modules/rc-slider/es/index.js"),s=n("./node_modules/react/index.js");n("./node_modules/rc-slider/assets/index.css");var c=function(e){function t(t){var n=e.call(this,t)||this;return n.onAfterChange=function(e){return function(t){e&&e(t),n.setState({value:t})}},n.onChange=function(e){return function(t){e&&e(t),n.setState({value:t})}},n.state={value:t.value},n}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.value,r=e.hideLabelValue,c=e.max,u=e.min,l=e.label,d=e.onAfterChange,p=e.onChange,f=e.style,h=i(e,["className","value","hideLabelValue","max","min","label","onAfterChange","onChange","style"]);return s.createElement("div",{className:t,style:o({padding:25},f)},!r&&s.createElement("p",null,l+": "+this.state.value),s.createElement(a.default,o({max:c,min:u,onAfterChange:this.onAfterChange(d),onChange:this.onChange(p),value:n},h)))},t}(s.Component);t.ChellSlider=c,t.default=c},"./src/component/widget/SettingsPanel.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n("./node_modules/react/index.js"),s=n("./node_modules/semantic-ui-react/dist/es/index.js"),c=n("./src/data/ChellConfig.ts"),u=n("./src/component/widget/ChellRadioGroup.tsx"),l=n("./src/component/widget/ChellSlider.tsx"),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onButtonClick=function(e){return n.setState({visible:!n.state.visible})},n.renderSettingsButton=function(){return a.createElement(s.Button,{icon:"settings",basic:!0,floated:"right",onClick:n.onButtonClick})},n.state={visible:!1},n}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.configurations,r=e.width,c=i(e,["children","configurations","width"]),u=this.state.visible;return a.createElement("div",null,a.createElement(s.Grid,{columns:1},a.createElement(s.Grid.Column,null,this.renderSettingsButton()),a.createElement(s.Sidebar.Pushable,null,a.createElement(s.Sidebar,o({as:s.Menu,animation:"overlay",style:{width:r,opacity:.85},vertical:!0,visible:u},c),this.renderConfigurations(n)),a.createElement(s.Sidebar.Pusher,null,t))))},t.prototype.renderConfigurations=function(e){var t=this;return a.createElement(s.Grid,{centered:!0},e.map(function(e,n){var r=e.id?e.id:e.name.toLowerCase().split(" ").join("-")+"-"+n;switch(e.type){case c.CONFIGURATION_COMPONENT_TYPE.BUTTON:return a.createElement(s.Grid.Row,{key:r},t.renderConfigurationButton(e,r));case c.CONFIGURATION_COMPONENT_TYPE.RADIO:return a.createElement(s.Grid.Row,{key:r},t.renderConfigurationRadioButton(e,r));case c.CONFIGURATION_COMPONENT_TYPE.SLIDER:return a.createElement(s.Grid.Row,{key:r},t.renderConfigurationSlider(e,r))}}))},t.prototype.renderConfigurationButton=function(e,t){return a.createElement(s.Button,{compact:!0,id:t,onClick:e.onClick,style:o({},e.style)},e.name)},t.prototype.renderConfigurationRadioButton=function(e,t){return a.createElement(u.ChellRadioGroup,{id:t,options:e.options,onChange:e.onChange,style:o({color:"white"},e.style)})},t.prototype.renderConfigurationSlider=function(e,t){return a.createElement(l.ChellSlider,{className:t,label:e.name,max:e.values.max,min:e.values.min,onChange:e.onChange,style:o({color:"white"},e.style),value:e.values.current})},t.defaultProps={configurations:new Array,direction:"left",inverted:!0,width:"100%"},t}(a.Component);t.SettingsPanel=d,t.default=d},"./src/context/CouplingContext.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n("./node_modules/react/index.js"),a=n("./src/data/CouplingContainer.ts"),s=n("./src/context/ResidueContext.tsx"),c=n("./src/context/SecondaryStructureContext.tsx");t.initialCouplingContext={couplingScores:new a.CouplingContainer};var u=function(e){function n(t){var n=e.call(this,t)||this;return n.state={couplingScores:new a.CouplingContainer},n}return r(n,e),n.prototype.render=function(){return i.createElement(c.SecondaryStructureContext,null,i.createElement(s.ResidueContext,null,i.createElement(t.CouplingContext.Provider,{value:this.state},this.props.children)))},n}(i.Component);t.CouplingContextClass=u,t.CouplingContext=i.createContext(t.initialCouplingContext);var l=function(e){return function(n){return i.createElement(t.CouplingContext.Consumer,null,function(t){return i.createElement(c.SecondaryStructureContextWrapper.Consumer,null,function(r){return i.createElement(s.ResidueContextWrapper.Consumer,null,function(a){return i.createElement(e,o({},n,{residueContext:o({},a),secondaryStructureContext:o({},r),couplingContext:o({},t)}))})})})}};t.withCouplingContext=l,t.default=l},"./src/context/ResidueContext.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n("./node_modules/react/index.js");t.initialResidueContext={addCandidateResidues:function(e){},addHoveredResidues:function(e){},addLockedResiduePair:function(e){},candidateResidues:new Array,clearAllResidues:function(){},hoveredResidues:new Array,lockedResiduePairs:new Map,removeAllLockedResiduePairs:function(){},removeCandidateResidues:function(){},removeHoveredResidues:function(){},removeLockedResiduePair:function(e){},removeNonLockedResidues:function(){},toggleLockedResiduePair:function(e){}};var a=function(e){function n(n){var r=e.call(this,n)||this;return r.onAddCandidateResidues=function(e){r.setState({candidateResidues:e.sort()})},r.onAddHoveredResidues=function(e){r.setState({hoveredResidues:e.sort()})},r.onAddLockedResiduePair=function(e){var t=r.state.lockedResiduePairs,n=e.sort(),o=n.toString();if(!t.has(o)){var i=new Map(t);i.set(o,n),r.setState({lockedResiduePairs:i})}},r.onClearAllResidues=function(){r.setState({candidateResidues:new Array,hoveredResidues:new Array,lockedResiduePairs:new Map})},r.onRemoveAllLockedResiduePairs=function(){r.setState({lockedResiduePairs:new Map})},r.onRemoveCandidateResidue=function(){r.setState({candidateResidues:new Array})},r.onRemoveHoveredResidues=function(){r.setState({hoveredResidues:new Array})},r.onRemoveLockedResiduePair=function(e){var t=e.sort().join(","),n=r.state.lockedResiduePairs;if(n.has(t)){var o=new Map(n);o.delete(t),r.setState({lockedResiduePairs:o})}},r.onRemoveNonLockedResidues=function(){r.setState({candidateResidues:new Array,hoveredResidues:new Array})},r.onToggleLockedResiduePair=function(e){var t=r.state.lockedResiduePairs,n=e.sort(),o=n.toString(),i=new Map(t);t.has(o)?i.delete(o):i.set(o,n),r.setState({lockedResiduePairs:i})},r.state=o({},t.initialResidueContext,{addCandidateResidues:r.onAddCandidateResidues,addHoveredResidues:r.onAddHoveredResidues,addLockedResiduePair:r.onAddLockedResiduePair,clearAllResidues:r.onClearAllResidues,removeAllLockedResiduePairs:r.onRemoveAllLockedResiduePairs,removeCandidateResidues:r.onRemoveCandidateResidue,removeHoveredResidues:r.onRemoveHoveredResidues,removeLockedResiduePair:r.onRemoveLockedResiduePair,removeNonLockedResidues:r.onRemoveNonLockedResidues,toggleLockedResiduePair:r.onToggleLockedResiduePair}),r}return r(n,e),n.prototype.render=function(){return i.createElement(s.Provider,{value:this.state},this.props.children)},n}(i.Component);t.ResidueContext=a;var s=i.createContext(o({},t.initialResidueContext));t.ResidueContextWrapper=s,t.withResidueContext=function(e){return function(t){return i.createElement(s.Consumer,null,function(n){return i.createElement(e,o({},t,{residueContext:n}))})}},t.default=s},"./src/context/SecondaryStructureContext.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n("./node_modules/react/index.js");t.initialSecondaryStructureContext={addSecondaryStructure:function(e){},clearSecondaryStructure:function(){},removeSecondaryStructure:function(e){},selectedSecondaryStructures:new Array,temporarySecondaryStructures:new Array,toggleSecondaryStructure:function(e){}};var c=function(e){function t(t){var n=e.call(this,t)||this;return n.onAddSecondaryStructure=function(){return function(e){n.state.selectedSecondaryStructures.includes(e)||n.setState({selectedSecondaryStructures:a(n.state.selectedSecondaryStructures,[e])})}},n.onClearSecondaryStructure=function(){return function(){n.setState({selectedSecondaryStructures:new Array,temporarySecondaryStructures:new Array})}},n.onRemoveSecondaryStructure=function(){return function(e){var t=n.state.selectedSecondaryStructures;n.setState({selectedSecondaryStructures:t.filter(function(n,r){return r!==t.indexOf(e)}),temporarySecondaryStructures:t.filter(function(n,r){return r!==t.indexOf(e)})})}},n.onToggleSecondaryStructure=function(){return function(e){var t=n.state.temporarySecondaryStructures;n.state.temporarySecondaryStructures.includes(e)?n.setState({temporarySecondaryStructures:t.filter(function(e,n){return n!==t.indexOf(e)})}):n.setState({temporarySecondaryStructures:a(n.state.temporarySecondaryStructures,[e])})}},n.state={addSecondaryStructure:n.onAddSecondaryStructure(),clearSecondaryStructure:n.onClearSecondaryStructure(),removeSecondaryStructure:n.onRemoveSecondaryStructure(),selectedSecondaryStructures:new Array,temporarySecondaryStructures:new Array,toggleSecondaryStructure:n.onToggleSecondaryStructure()},n}return r(t,e),t.prototype.render=function(){return s.createElement(u.Provider,{value:this.state},this.props.children)},t}(s.Component);t.SecondaryStructureContext=c;var u=s.createContext(t.initialSecondaryStructureContext);t.SecondaryStructureContextWrapper=u,t.withSecondaryStructureContext=function(e){return function(t){return s.createElement(u.Consumer,null,function(n){return s.createElement(e,o({},t,{secondaryStructureContext:n}))})}},t.default=u},"./src/data/AminoAcid.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={fullName:"Alanine",singleLetterCode:"A",threeLetterCode:"ALA"},o={fullName:"Arginine",singleLetterCode:"R",threeLetterCode:"ARG"},i={fullName:"Asparagine",singleLetterCode:"N",threeLetterCode:"ASN"},a={fullName:"Aspartic Acid",singleLetterCode:"D",threeLetterCode:"ASP"},s={fullName:"Cysteine",singleLetterCode:"C",threeLetterCode:"CYS"},c={fullName:"Glutamine",singleLetterCode:"Q",threeLetterCode:"GLN"},u={fullName:"Glutamic Acid",singleLetterCode:"E",threeLetterCode:"GLU"},l={fullName:"Glycine",singleLetterCode:"G",threeLetterCode:"GLY"},d={fullName:"Histidine",singleLetterCode:"H",threeLetterCode:"HIS"},p={fullName:"Isoleucine",singleLetterCode:"I",threeLetterCode:"ILE"},f={fullName:"Leucine",singleLetterCode:"L",threeLetterCode:"LEU"},h={fullName:"Lysine",singleLetterCode:"K",threeLetterCode:"LYS"},y={fullName:"Methionine",singleLetterCode:"M",threeLetterCode:"MET"},v={fullName:"Phenylalanine",singleLetterCode:"F",threeLetterCode:"PHE"},g={fullName:"Proline",singleLetterCode:"P",threeLetterCode:"PRO"},m={fullName:"Serine",singleLetterCode:"S",threeLetterCode:"SER"},C={fullName:"Threonine",singleLetterCode:"T",threeLetterCode:"THR"},_={fullName:"Tryptophan",singleLetterCode:"W",threeLetterCode:"TRP"},S={fullName:"Tyrosine",singleLetterCode:"Y",threeLetterCode:"TYR"},x={fullName:"Valine",singleLetterCode:"V",threeLetterCode:"VAL"};t.AMINO_ACIDS_BY_SINGLE_LETTER_CODE={A:r,R:o,N:i,D:a,C:s,Q:c,E:u,G:l,H:d,I:p,L:f,K:h,M:y,F:v,P:g,S:m,T:C,W:_,Y:S,V:x},t.AMINO_ACIDS_BY_THREE_LETTER_CODE={ALA:r,ARG:o,ASN:i,ASP:a,CYS:s,GLN:c,GLU:u,GLY:l,HIS:d,ILE:p,LEU:f,LYS:h,MET:y,PHE:v,PRO:g,SER:m,THR:C,TRP:_,TYR:S,VAL:x},t.AMINO_ACIDS=[r,o,i,a,s,c,u,l,d,p,f,h,y,v,g,m,C,_,S,x]},"./src/data/Chell1DSection.ts":function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,n){void 0===n&&(n=t),this.label=e,this.sectionEnd=0,this.sectionStart=0,this.sectionEnd=Math.max(n,t),this.sectionStart=Math.min(t,n)}return Object.defineProperty(e.prototype,"end",{get:function(){return this.sectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.sectionEnd-this.sectionStart+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.sectionStart},enumerable:!0,configurable:!0}),e.prototype.contains=function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var i=r(n),a=i.next();!a.done;a=i.next()){var s=a.value;if(s<this.sectionStart||s>this.sectionEnd||void 0===s)return!1}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!0},e.prototype.updateStart=function(e){e>this.sectionEnd?(this.sectionStart=this.sectionEnd,this.sectionEnd=e):this.sectionStart=e},e.prototype.updateEnd=function(e){e<this.sectionStart?(this.sectionEnd=this.sectionStart,this.sectionStart=e):this.sectionEnd=e},e}();t.Chell1DSection=o,t.default=o},"./src/data/ChellConfig.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BUTTON="BUTTON",e.RADIO="RADIO",e.SLIDER="SLIDER"}(t.CONFIGURATION_COMPONENT_TYPE||(t.CONFIGURATION_COMPONENT_TYPE={}))},"./src/data/ChellPDB.ts":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n("./node_modules/ngl/dist/ngl.esm.js"),a=n("./src/data/AminoAcid.ts"),s=n("./src/data/chell-data.ts"),c=n("./src/data/Chell1DSection.ts"),u=n("./src/data/CouplingContainer.ts"),l=function(){function e(){this.contactInfo=void 0,this.nglData=new i.Structure}return e.createPDB=function(t){return void 0===t&&(t=""),r(this,void 0,void 0,function(){var n,r;return o(this,function(o){switch(o.label){case 0:return n=new e,r=n,[4,i.autoLoad(t)];case 1:return r.nglData=o.sent(),[2,n]}})})},e.createPDBFromNGLData=function(t){var n=new e;return n.nglData=t,n},Object.defineProperty(e.prototype,"contactInformation",{get:function(){var e=this;if(!this.contactInfo){var t=new u.CouplingContainer;this.nglData.eachResidue(function(n){if(n.isProtein()){var r=n.resno;e.nglData.eachResidue(function(n){var o=n.resno;n.isProtein()&&r!==o&&t.addCouplingScore({dist:e.getMinDistBetweenResidues(r,o).dist,i:r,j:o})})}}),this.contactInfo=t}return this.contactInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nglStructure",{get:function(){return this.nglData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryStructure",{get:function(){var e=new Array;return this.nglData.eachResidue(function(t){if(t.isProtein()){var n="C";if(t.isSheet())n="E";else if(t.isHelix())n="H";else if(t.isTurn())return;e.push({resno:t.resno,structId:n})}}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryStructureSections",{get:function(){var e=new Array;return this.nglData.eachResidue(function(t){if(t.isProtein()){for(var n=t.chainIndex;!e[n];)e.push(new Array);var r="C";if(t.isSheet())r="E";else if(t.isHelix())r="H";else if(t.isTurn())return;e[n].length>=1&&e[n][e[n].length-1].label===r?e[n][e[n].length-1].updateEnd(t.resno):e[n].push(new c.default(r,t.resno))}}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sequence",{get:function(){return this.nglData?this.nglData.getSequence().join(""):""},enumerable:!0,configurable:!0}),e.prototype.eachResidue=function(e){this.nglData.eachResidue(e)},e.prototype.amendPDBWithCouplingScores=function(t,n){var r=this,o=new u.CouplingContainer(t),i=this.nglData.atomMap.dict[e.NGL_C_ALPHA_INDEX],a={};return this.nglData.eachResidue(function(e){r.nglData.eachResidue(function(t){if(e.isProtein()&&t.isProtein())if(n===s.CONTACT_DISTANCE_PROXIMITY.C_ALPHA){var c=r.getCAlphaAtomIndexFromResidue(e.index,i),u=r.getCAlphaAtomIndexFromResidue(t.index,i);o.addCouplingScore({dist:r.nglData.getAtomProxy(c).distanceTo(r.nglData.getAtomProxy(u)),i:e.resno,j:t.resno})}else{var l=Math.min(e.resno,t.resno)+","+Math.max(e.resno,t.resno);a[l]||(a[l]=r.getMinDistBetweenResidueIndices(e.index,t.index).dist),o.addCouplingScore({dist:a[l],i:e.resno,j:t.resno})}})}),this.contactInfo=o,this.contactInfo},e.prototype.getCAlphaAtomIndexFromResidue=function(e,t){for(var n=this.nglData.residueStore,r=n.atomOffset[e],o=n.atomCount[e],i=r;n.residueTypeId[i]!==t&&i<r+o;)i++;return i},e.prototype.getMinDistBetweenResidues=function(e,t){return this.getMinDistBetweenResidueIndices(this.nglData.residueStore.resno.indexOf(e),this.nglData.residueStore.resno.indexOf(t))},e.prototype.getResidueNumberingMismatches=function(e){var t=new Array;return this.eachResidue(function(n){var r=n.resname.toUpperCase(),o=e.getAminoAcidOfContact(n.resno);o&&a.AMINO_ACIDS_BY_THREE_LETTER_CODE[r]!==a.AMINO_ACIDS_BY_SINGLE_LETTER_CODE[o.singleLetterCode]&&t.push({couplingAminoAcid:o,pdbAminoAcid:a.AMINO_ACIDS_BY_THREE_LETTER_CODE[r],resno:n.resno})}),t},e.prototype.getMinDistBetweenResidueIndices=function(e,t){for(var n=this.nglData.residueStore,r=n.atomCount[e],o=n.atomCount[t],i=n.atomOffset[e],a=n.atomOffset[t],s={atomIndexI:-1,atomIndexJ:-1,dist:Number.MAX_SAFE_INTEGER},c=0;c<r;++c)for(var u=0;u<o;++u){var l=i+c,d=a+u,p=this.nglData.getAtomProxy(l).distanceTo(this.nglData.getAtomProxy(d));p<s.dist&&(s={atomIndexI:l,atomIndexJ:d,dist:p})}return s},e.NGL_C_ALPHA_INDEX="CA|C",e}();t.ChellPDB=l},"./src/data/CouplingContainer.ts":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n("./src/data/AminoAcid.ts"),a=function(){function e(e){var t,n;void 0===e&&(e=[]);var r=this;this.contacts=new Array,this.totalStoredContacts=0,this.indexRange={max:50,min:1},this.rowCounter=0,this.colCounter=0,this.getCouplingScore=function(e,t){return r.contacts[Math.min(e,t)-1][Math.max(e,t)-1]},this.includes=function(e,t){return void 0!==r.contacts[Math.min(e,t)-1][Math.max(e,t)-1]};try{for(var i=o(e),a=i.next();!a.done;a=i.next()){var s=a.value;this.addCouplingScore(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return Object.defineProperty(e.prototype,"allContacts",{get:function(){return this.contacts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chainLength",{get:function(){return this.indexRange.max-this.indexRange.min+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rankedContacts",{get:function(){return Array.from(this).sort(function(e,t){return e.cn&&t.cn?t.cn-e.cn:e.cn&&!t.cn?-1:!e.cn&&t.cn?1:0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"residueIndexRange",{get:function(){return this.indexRange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sequence",{get:function(){for(var e="",t=this.indexRange.min;t<=this.indexRange.max;++t){var n=this.getAminoAcidOfContact(t);n&&(e+=n.singleLetterCode)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalContacts",{get:function(){return this.totalStoredContacts},enumerable:!0,configurable:!0}),e.prototype[Symbol.iterator]=function(){return this},e.prototype.addCouplingScore=function(e){var t=e.i,n=e.j,o=Math.min(t,n)-1,i=Math.max(t,n)-1;this.contacts[o]||(this.contacts[o]=new Array),this.contacts[o][i]?this.contacts[o][i]=r({},this.contacts[o][i],e):(this.totalStoredContacts++,this.contacts[o][i]=e),this.indexRange={max:Math.max(this.indexRange.max,i+1),min:Math.min(this.indexRange.min,o+1)}},e.prototype.getAminoAcidOfContact=function(e){var t,n,r,a;if(!(e>this.chainLength+1))try{for(var s=o(this.allContacts),c=s.next();!c.done;c=s.next()){var u=c.value;if(u)try{for(var l=o(u),d=l.next();!d.done;d=l.next()){var p=d.value;if(p&&p.i===e&&p.A_i)return i.AMINO_ACIDS_BY_SINGLE_LETTER_CODE[p.A_i];if(p&&p.j===e&&p.A_j)return i.AMINO_ACIDS_BY_SINGLE_LETTER_CODE[p.A_j]}}catch(e){r={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e.prototype.getObservedContacts=function(e,t){var n,r;void 0===e&&(e=5),void 0===t&&(t=5);var i=new Array;try{for(var a=o(this),s=a.next();!s.done;s=a.next()){var c=s.value;c.dist<=e&&Math.abs(c.i-c.j)>=t&&i.push(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},e.prototype.getPredictedContacts=function(e,t,n){var r,i;void 0===t&&(t=5),void 0===n&&(n=5);var a={correct:new Array,predicted:new Array};try{for(var s=o(this.rankedContacts.filter(function(e){return Math.abs(e.i-e.j)>=t}).slice(0,e)),c=s.next();!c.done;c=s.next()){var u=c.value;u.dist<n&&a.correct.push(u),a.predicted.push(u)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},e.prototype.next=function(){for(var e=this.rowCounter;e<this.contacts.length;++e)if(this.contacts[e]){for(var t=this.colCounter;t<this.contacts[e].length;++t){var n=this.contacts[e][t];if(n)return this.rowCounter=e,this.colCounter=t+1,{done:!1,value:n}}this.colCounter=0}return this.rowCounter=0,this.colCounter=0,{done:!0,value:null}},e}();t.CouplingContainer=a},"./src/data/chell-data.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.CONTACT_MAP="Contact Map",e.INFO_PANEL="Info Panel",e.NGL="NGL",e.SPRING="Spring",e["TENSOR-T-SNE"]="TENSOR-T-SNE",e["T-SNE"]="T-SNE",e["T-SNE-FRAME"]="T-SNE-FRAME"}(t.VIZ_TYPE||(t.VIZ_TYPE={})),function(e){e.CLOSEST="CLOSEST",e.C_ALPHA="C-"}(t.CONTACT_DISTANCE_PROXIMITY||(t.CONTACT_DISTANCE_PROXIMITY={})),function(e){e.G="310_HELIX",e.H="ALPHA_HELIX",e.I="PI_HELIX",e.T="HYDROGEN_BONDED_TURN",e.E="BETA_SHEET",e.B="BETA_BRIDGE",e.S="BEND",e.C="COIL"}(t.SECONDARY_STRUCTURE_CODES||(t.SECONDARY_STRUCTURE_CODES={})),function(e){e[e.AFTER_PLOT=0]="AFTER_PLOT",e[e.CLICK=1]="CLICK",e[e.DOUBLE_CLICK=2]="DOUBLE_CLICK",e[e.HOVER=3]="HOVER",e[e.RELAYOUT=4]="RELAYOUT",e[e.SELECTION=5]="SELECTION",e[e.UNHOVER=6]="UNHOVER"}(t.CHELL_CHART_EVENT_TYPE||(t.CHELL_CHART_EVENT_TYPE={})),function(e){e[e.AXIS=0]="AXIS",e[e.POINT=1]="POINT"}(t.CHELL_CHART_PIECE||(t.CHELL_CHART_PIECE={}))},"./src/data/event/ChellChartEvent.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./src/data/chell-data.ts"),o=function(){function e(e,t,n){void 0===n&&(n=[]),this.type=e,this.chartPiece=t,this.selectedPoints=n}return e.prototype.isAxis=function(){return this.chartPiece===r.CHELL_CHART_PIECE.AXIS},e}();t.ChellChartEvent=o,t.default=o},"./src/helper/CouplingMapper.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCouplingHeaderIndices=function(e){var t=function(e){return{A_i:e.length-2,A_j:e.length-1,cn:2,dist:3,i:0,j:1}}(e);return Object.entries(t).map(function(n){t[n[0]]=e.includes(n[0])?e.indexOf(n[0]):n[1]}),t}},"./src/helper/DataHelper.ts":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},a=this;Object.defineProperty(t,"__esModule",{value:!0});var s=n("./src/data/chell-data.ts"),c=n("./src/data/CouplingContainer.ts"),u=n("./src/helper/FetchHelper.ts"),l=n("./node_modules/ngl/dist/ngl.esm.js"),d=n("./src/data/ChellPDB.ts"),p=n("./src/helper/CouplingMapper.ts"),f=n("./src/helper/ResidueMapper.ts");t.fetchAppropriateData=function(e,n){return r(a,void 0,void 0,function(){return o(this,function(r){switch(e){case s.VIZ_TYPE["T-SNE"]:case s.VIZ_TYPE["T-SNE-FRAME"]:case s.VIZ_TYPE["TENSOR-T-SNE"]:return[2,t.fetchTSneCoordinateData(n)];case s.VIZ_TYPE.SPRING:return[2,h(n)];case s.VIZ_TYPE.NGL:return[2,t.fetchNGLDataFromDirectory(n)];case s.VIZ_TYPE.CONTACT_MAP:case s.VIZ_TYPE.INFO_PANEL:return[2,t.fetchContactMapData(n)];default:return[2,Promise.reject({error:"Currently no appropriate data getter for "+e})]}return[2]})})},t.fetchAppropriateDataFromFile=function(e,n){return r(a,void 0,void 0,function(){var r,i;return o(this,function(o){switch(o.label){case 0:switch(e){case s.VIZ_TYPE.NGL:return[3,1];case s.VIZ_TYPE.CONTACT_MAP:return[3,2]}return[3,4];case 1:return[2,t.fetchNGLDataFromFile(n)];case 2:return r={},i=t.getCouplingScoresData,[4,u.readFileAsText(n)];case 3:return[2,(r.couplingScores=i.apply(void 0,[o.sent()]),r)];case 4:return[2,Promise.reject({error:"Currently no appropriate data getter for "+e+" files"})]}})})};var h=function(e){return r(a,void 0,void 0,function(){var n,r,i,a;return o(this,function(o){switch(o.label){case 0:return[4,t.fetchSpringCoordinateData(e+"/coordinates.txt")];case 1:return n=o.sent(),[4,m(e+"/graph_data.json")];case 2:return r=o.sent(),[4,g(e+"/categorical_coloring_data.json")];case 3:return i=o.sent(),a=v(r,n,i),r.links=y(r.links,a),[2,r]}})})},y=function(e,t){return e.map(function(e){var n=t[e.source],r=t[e.target];return n&&r&&(e.source=n,e.target=r),e})},v=function(e,t,n){for(var r={},o=0;o<e.nodes.length;++o){var i=e.nodes[o];r[i.number]=i,i.number in t&&(i.fixed=!0,i.x=t[i.number][0],i.y=t[i.number][1]);var a=n.label_list[o];i.category=a,i.colorHex=n.label_colors[a]}return r},g=function(e){return r(a,void 0,void 0,function(){var t,n,r,a,s,c,l,d,p,f,h;return o(this,function(o){switch(o.label){case 0:return[4,u.fetchJSONFile(e)];case 1:if(r=o.sent(),a=Object.keys(r)[0],!(s=r[a]).label_colors||!s.label_list)throw new Error("Unable to parse color data - does it have keys named 'label_colors' and 'label_list'");c={label_colors:{},label_list:s.label_list},l=r[Object.keys(r)[0]].label_colors;try{for(d=i(Object.keys(l)),p=d.next();!p.done;p=d.next())f=p.value,"number"==typeof(h=l[f])?c.label_colors[f]=h:"#"===h.charAt(0)?c.label_colors[f]=Number.parseInt("0x"+h.slice(1),16):c.label_colors[f]=Number.parseInt(h,16)}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return[2,c]}})})};t.fetchSpringCoordinateData=function(e){return r(a,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return[4,u.fetchCSVFile(e)];case 1:return t=r.sent(),n=[],t.split("\n").forEach(function(e,t,r){var o=e.split(",");if(o.length>=3){var i=parseFloat(o[1].trim()),a=parseFloat(o[2].trim()),s=parseInt(o[0].trim(),10);n[s]=[i,a]}else if(0!==e.localeCompare(""))throw new Error("Unable to parse coordinate data - Row "+t+" does not have at least 3 columns!")}),[2,n]}})})},t.fetchTSneCoordinateData=function(e){return r(a,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return[4,u.fetchCSVFile(e+"/tsne_output.csv")];case 1:return t=r.sent(),n=[],t.split("\n").forEach(function(e){if(e.length>0){var t=e.split(","),r=[parseFloat(t[0]),parseFloat(t[1])];n.push(r)}}),[2,n]}})})};var m=function(e){return r(a,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,u.fetchJSONFile(e)];case 1:if(!(t=n.sent()).nodes||!t.links)throw new Error("Unable to parse graph data - does it have keys named 'nodes' and 'links'");return[2,t]}})})};t.fetchNGLDataFromDirectory=function(e){return r(a,void 0,void 0,function(){var n;return o(this,function(r){return 0===e.length?[2,Promise.reject("Empty path.")]:(n=e+"/protein.pdb",[2,t.fetchNGLDataFromFile(n)])})})},t.fetchNGLDataFromFile=function(e,t){return void 0===t&&(t={}),r(a,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,l.autoLoad(e,t)];case 1:return[2,n.sent()]}})})},t.fetchContactMapData=function(e){return r(a,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:return 0===e.length?[2,Promise.reject("Empty path.")]:(n=["coupling_scores.csv","residue_mapping.csv"],[4,Promise.all(n.map(function(t){return u.fetchCSVFile(e+"/"+t)}))]);case 1:return r=o.sent(),[4,d.ChellPDB.createPDB(e+"/protein.pdb")];case 2:return i=o.sent(),[2,{couplingScores:t.getCouplingScoresData(r[0],f.generateResidueMapping(r[1])),pdbData:i,secondaryStructures:[]}]}})})},t.getCouplingScoresData=function(e,t){void 0===t&&(t=[]);var n=e.split("\n")[0].split(","),r=p.getCouplingHeaderIndices(n),o=n.includes("dist"),i=new c.CouplingContainer;return e.split("\n").slice(o?1:0).filter(function(e){return e.split(",").length>=12}).map(function(e){var n=e.split(",");if(t.length>=1){var o=t.findIndex(function(e){return e.uniProtResno===parseInt(n[0],10)}),a=t.findIndex(function(e){return e.uniProtResno===parseInt(n[1],10)});i.addCouplingScore({A_i:t[o].pdbResCode,A_j:t[a].pdbResCode,cn:parseFloat(n[r.cn]),dist:parseFloat(n[r.dist]),i:t[o].pdbResno,j:t[a].pdbResno})}else i.addCouplingScore({A_i:n[r.A_i],A_j:n[r.A_j],cn:parseFloat(n[r.cn]),dist:parseFloat(n[r.dist]),i:parseInt(n[r.i],10),j:parseInt(n[r.j],10)})}),i},t.augmentCouplingScoresWithResidueMapping=function(e,t){var n,r;void 0===t&&(t=[]);var o=new c.CouplingContainer,a=function(e){var n=t.findIndex(function(t){return t.uniProtResno===e.i}),r=t.findIndex(function(t){return t.uniProtResno===e.j});o.addCouplingScore({A_i:t[n].pdbResCode,A_j:t[r].pdbResCode,cn:e.cn,dist:e.dist,i:t[n].pdbResno,j:t[r].pdbResno})};try{for(var s=i(e),u=s.next();!u.done;u=s.next()){a(u.value)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},t.getSecondaryStructureData=function(e){return e.split("\n").slice(1).filter(function(e){return e.split(",").length>=3}).map(function(e){var t=e.split(",");return{resno:parseFloat(t[1]),structId:t[2]}})}},"./src/helper/FetchHelper.ts":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this;Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCSVFile=function(e){return r(i,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:if((t=n.sent()).ok)return[2,t.text()];throw new Error(a("CSV",t))}})})},t.fetchJSONFile=function(e){return r(i,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:if((t=n.sent()).ok)return[2,t.json()];throw new Error(a("JSON",t))}})})};var a=function(e,t){return"Chell-viz error fetching "+e+" File!\nStatus: "+t.status+"\nMessage: "+t.statusText+"\n"};t.readFileAsText=function(e){var t=new FileReader;return new Promise(function(n,r){t.onerror=function(){t.abort(),r(new DOMException("Problem parsing input file."))},t.onload=function(){n(t.result)},t.readAsText(e)})}},"./src/helper/NGLHelper.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDistanceRepresentation=function(e,t,n,r){return void 0===n&&(n="skyblue"),void 0===r&&(r="angstrom"),e.addRepresentation("distance",{atomPair:Array.isArray(t)?[t]:[t.split(",")],color:n,labelUnit:r})},t.createBallStickRepresentation=function(e,t){return e.addRepresentation("ball+stick",{sele:t.join(", ")})},t.createSecStructRepresentation=function(e,t,n,r){void 0===n&&(n=2),void 0===r&&(r="yellow");var o=e.addRepresentation("cartoon",{color:r,radiusScale:n,sele:t.start+"-"+t.end});return o.setParameters({wireframe:!0}),o}},"./src/helper/PlotlyHelper.ts":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n("./src/component/chart/PlotlyChart.tsx");t.generateScatterGLData=function(e,n){return void 0===n&&(n=!1),r({},t.generateScatterData(e,n),{type:a.PLOTLY_CHART_TYPE.scattergl})},t.generateScatterData=function(e,t){void 0===t&&(t=!1);var n=e.marker,o=e.points,c=e.subtitle,u=e.name,l=o.map(function(e){return e.i}),d=o.map(function(e){return e.j}),p=o.map(function(e){return e.dist});return{hoverinfo:"x+y+z",marker:r({color:s(t,p,e),size:e.nodeSize},n),mode:"markers",name:u+" "+c,type:a.PLOTLY_CHART_TYPE.scatter,x:t?i(l,d):l,y:t?i(d,l):d,z:t?i(p,p):p}};var s=function(e,t,n){var r=e?2*t.length:t.length,o=new Array(r);if(n.marker&&"string"==typeof n.marker.color)return o.fill(n.marker.color);var a=t.map(function(e){return e.toString()});return e?i(a,a):a};t.generateFloat32ArrayFromContacts=function(e){var t=new Float32Array(2*e.length);return e.forEach(function(e,n){t[2*n]=e.i,t[2*n+1]=e.j}),t},t.generatePointCloudData=function(e,n){void 0===n&&(n=!1);var o=e.points,s=t.generateFloat32ArrayFromContacts(o);return{marker:r({},e.marker,{sizemax:2*e.nodeSize,sizemin:e.nodeSize}),mode:"markers",type:a.PLOTLY_CHART_TYPE.pointcloud,xy:n?new Float32Array(i(Array.from(s),Array.from(s).slice().reverse())):s}}},"./src/helper/ResidueMapper.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["up_index","up_residue","pdb_index","pdb_residue"];t.generateResidueMapping=function(e){var t=e.split("\n")[0].split("\t"),n=o(t);return e.split("\n").slice(1).reduce(function(e,t){var o=t.split("\t");return o.length>=r.length&&e.push({pdbResCode:o[n.pdb_residue],pdbResno:parseInt(o[n.pdb_index],10),uniProtResCode:o[n.up_residue],uniProtResno:parseInt(o[n.up_index],10)}),e},new Array)};var o=function(e){var t={};return e.length>=r.length&&r.map(function(n){if(!e.includes(n))throw new Error("Missing error "+n+" in indextableplus file!");t[n]=e.indexOf(n)}),t}}});