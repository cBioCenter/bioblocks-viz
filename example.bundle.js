(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./examples/example.tsx":function(e,t,n){"use strict";var r,a,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,s)}l((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n("./node_modules/react/index.js"),d=n("./node_modules/react-dom/index.js"),p=n("./node_modules/semantic-ui-react/dist/es/index.js"),m=n("./src/index.ts"),g=function(e){function t(n){var r=e.call(this,n)||this;return r.renderCouplingComponents=function(e,t){var n=(void 0===e?r.props:e).style,a=void 0===t?r.state:t,i=a.arePredictionsAvailable,o=a.couplingScores,s=a.errorMsg,l=a.isResidueMappingNeeded,c=a.measuredProximity,d=a.pdbData;return u.createElement("div",null,u.createElement(p.Header,{as:"h1",attached:"top"},"ContactMap.org: 2D and 3D Visualization"),s.length>1&&r.renderErrorMessage(),!d&&0===o.length&&r.renderStartMessage(),u.createElement(p.Segment,{attached:!0,raised:!0},u.createElement(m.CouplingContextProvider,null,u.createElement(m.SecondaryStructureContextConsumer,null,function(e){return u.createElement(m.ResidueContextConsumer,null,function(t){return u.createElement(p.Grid,{centered:!0},r.renderUploadButtonsRow(l,t,e),r.renderChellComponents(n,i,c,d))})}))),r.renderFooter())},r.renderErrorMessage=function(e){var t=void 0===e?r.state:e,n=t.errorMsg,a=t.isResidueMappingNeeded,i=t.mismatches,o=t.pdbData;return u.createElement(p.Message,{warning:!0},a&&o?u.createElement("div",null,u.createElement(p.Message.Header,null,"Residue numbering mismatch detected. Please upload a file to correct the position numbering differences.",u.createElement("br",null),"EVCouplings and EVFold outputs this file in the ",u.createElement("strong",null,"OUTPUT")," directory.\n                This file might be named similar to\n                '"+o.name+".csv' or '"+o.name+".indextableplus'"),u.createElement(p.Message.List,null,n),u.createElement(p.Message.Content,null,u.createElement(p.Accordion,{fluid:!0,exclusive:!1,defaultActiveIndex:[],panels:[r.renderSequenceAccordionMessage("PDB sequence",o.sequence,i),r.renderSequenceAccordionMessage("Couplings Score sequence",r.state[m.VIZ_TYPE.CONTACT_MAP].couplingScores.sequence,i)]}))):n)},r.renderFooter=function(){var e=u.createElement("a",{href:"https://github.com/cBioCenter/chell-viz"},"Chell"),t=[u.createElement(u.Fragment,null,"Powered by ",e,"!"),u.createElement(u.Fragment,null,"They love me at the ",e,"sea."),u.createElement(u.Fragment,null,"Today's visualization has been brought to you by ",e,"."),u.createElement(u.Fragment,null,e,"sea, ",e,"sea, I believe..."),u.createElement(u.Fragment,null,"Now you're thinking with ",e,"!"),u.createElement(u.Fragment,null,"And ",e,"sea says she's got nowhere to go...")].map(function(e){return u.createElement(u.Fragment,{key:"random-chell-saying"},e)}),n=t[Math.floor(Math.random()*t.length)];return u.createElement("footer",{style:{padding:"25vh 0 25px 25px"}},n)},r.renderSequenceAccordionMessage=function(e,t,n){var r,a,i=0,o=new Array;try{for(var s=c(n),l=s.next();!l.done;l=s.next()){var d=l.value;o.push(u.createElement(u.Fragment,{key:"mismatch-"+d.resno},u.createElement("span",{style:{color:"black",fontSize:"12px"}},t.substr(i,d.resno)),u.createElement("span",{style:{color:"red",fontSize:"16px",textDecoration:"underline"}},t.charAt(d.resno)))),i=d.resno+2}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return o.push(u.createElement("span",{key:"mismatch-final",style:{color:"black",fontSize:"12px"}},t.substr(i))),{content:{content:u.createElement("p",{style:{width:"80%",wordBreak:"break-word"}},o)},key:"panel-"+e,title:{content:e+" ("+t.length+" Amino Acids)"}}},r.renderStartMessage=function(){return u.createElement(p.Message,null,"To get started, please upload either a PDB (.pdb) or EVCouplings score (.csv) file!"," ",u.createElement("br",null)," Check out the",u.createElement("a",{href:"evfold.org"}," EVFold"),", ",u.createElement("a",{href:"sanderlab.org/contact-maps/"},"Sander Lab"),", or",u.createElement("a",{href:"https://evcouplings.org/"}," EVCouplings ")," website to get these files.")},r.renderUploadForm=function(e,t,n,r,a){return void 0===a&&(a=[]),u.createElement(p.GridColumn,null,u.createElement(p.Label,{as:"label",basic:!0,htmlFor:t},u.createElement(p.Button,{disabled:r,icon:"upload",label:{basic:!0,content:n},labelPosition:"right"}),u.createElement("input",{accept:"."+a.join(",."),disabled:r,id:t,onChange:e,hidden:!0,type:"file",required:!0,multiple:!1})))},r.renderUploadLabel=function(e){return e?u.createElement(p.GridColumn,{verticalAlign:"middle",textAlign:"justified"},u.createElement(p.Label,null,e)):null},r.renderCouplingScoresUploadForm=function(e){var t=void 0===e?r.state:e,n=t.couplingScores,a=t.filenames;return u.createElement(p.GridRow,null,r.renderUploadLabel(a.couplings),r.renderUploadForm(r.onCouplingScoreUpload,"coupling-score","Coupling Scores",n.length>0,["csv"]))},r.renderChellComponents=function(e,t,n,a,i){return void 0===i&&(i="550px"),u.createElement(p.GridRow,{verticalAlign:"middle"},u.createElement(p.GridColumn,{width:6},r.renderContactMapCard(t,i,e,a)),u.createElement(p.GridColumn,{width:6},r.renderNGLCard(n,i,e)))},r.renderNGLCard=function(e,t,n){return u.createElement(p.Card,{raised:!0,style:{height:"615px",padding:"15px 15px 0 15px",width:"600px"}},u.createElement(m.NGLComponent,{data:r.state[m.VIZ_TYPE.NGL].pdbData,height:t,isDataLoading:r.state[m.VIZ_TYPE.NGL].isLoading,measuredProximity:e,onMeasuredProximityChange:r.onMeasuredProximityChange(),style:n,width:t}))},r.renderContactMapCard=function(e,t,n,a){return u.createElement(p.Card,{raised:!0,style:{height:"615px",padding:"15px 15px 0 15px",width:"600px"}},e?u.createElement(m.PredictedContactMap,{data:{couplingScores:r.state[m.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:a,secondaryStructures:r.state[m.VIZ_TYPE.CONTACT_MAP].secondaryStructures},height:t,isDataLoading:r.state[m.VIZ_TYPE.CONTACT_MAP].isLoading,style:n,width:t}):u.createElement(m.ContactMap,{data:{couplingScores:r.state[m.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:a,secondaryStructures:r.state[m.VIZ_TYPE.CONTACT_MAP].secondaryStructures},height:t,isDataLoading:r.state[m.VIZ_TYPE.CONTACT_MAP].isLoading,style:n,width:t}))},r.renderUploadButtonsRow=function(e,t,n){return u.createElement(p.GridRow,{columns:4,centered:!0,textAlign:"center",verticalAlign:"bottom"},u.createElement(p.GridColumn,null,r.renderCouplingScoresUploadForm()),u.createElement(p.GridColumn,null,r.renderPDBUploadForm()),e&&u.createElement(p.GridColumn,null,r.renderResidueMappingUploadForm()),u.createElement(p.GridColumn,null,r.renderClearAllButton(t,n)))},r.renderPDBUploadForm=function(e){var t=void 0===e?r.state:e,n=t.filenames,a=t.pdbData;return u.createElement(p.GridRow,null,r.renderUploadLabel(n.pdb),r.renderUploadForm(r.onPDBUpload,"pdb","PDB",void 0!==a,["pdb"]))},r.renderResidueMappingUploadForm=function(e){var t=(void 0===e?r.state:e).filenames;return u.createElement(p.GridRow,{verticalAlign:"middle",columns:1,centered:!0},r.renderUploadLabel(t.residue_mapper),r.renderUploadForm(r.onResidueMappingUpload,"residue-mapping","Residue Mapping",!1,["csv","indextable","indextableplus"]))},r.renderClearAllButton=function(e,t){return u.createElement(p.GridRow,{verticalAlign:"middle",columns:1,centered:!0},u.createElement(p.GridColumn,null,u.createElement(p.Label,{as:"label",basic:!0,htmlFor:"clear-data"},u.createElement(p.Button,{icon:"trash",label:{basic:!0,content:"Clean View"},labelPosition:"right",onClick:r.onClearAll(e,t)}))))},r.onClearAll=function(e,n){return function(){return s(r,void 0,void 0,function(){return l(this,function(r){return this.setState(t.initialState),e.clearAllResidues(),n.clearAllSecondaryStructures(),this.forceUpdate(),[2]})})}},r.onCouplingScoreUpload=function(e){return s(r,void 0,void 0,function(){var t,n,r,a,i,s,c,u,d,p,g,h;return l(this,function(l){switch(l.label){case 0:if(e.persist(),r=this.state,a=r.measuredProximity,i=r.pdbData,s=e.target.files,null===(c=s?s.item(0):null))return[3,6];if(!c.name.endsWith(".csv"))return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),this.setState(((t={})[m.VIZ_TYPE.CONTACT_MAP]=o({},this.state[m.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,m.readFileAsText(c)];case 2:return u=l.sent(),d=m.getCouplingScoresData(u,this.state.residueMapping),p=i?i.getResidueNumberingMismatches(d):[],g=p.length>0,this.setState(((n={})[m.VIZ_TYPE.CONTACT_MAP]={couplingScores:i?i.amendPDBWithCouplingScores(d.rankedContacts,a):d,isLoading:!1,pdbData:this.state.pdbData,secondaryStructures:[]},n.arePredictionsAvailable=!0,n.couplingScores=u,n.errorMsg="",n.filenames=o({},this.state.filenames,{couplings:c.name}),n.isResidueMappingNeeded=g,n)),[3,4];case 3:return h=l.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Coupling Score file '"+c.name+"' - Make sure the file ends in '.csv'!"}),l.label=6;case 6:return e.target.value="",[2]}})})},r.onPDBUpload=function(e){return s(r,void 0,void 0,function(){var t,n,r,a,i,s,c;return l(this,function(l){switch(l.label){case 0:return e.persist(),r=this.state.measuredProximity,a=e.target.files,null===(i=a?a.item(0):null)?[3,3]:i.name.endsWith(".pdb")?(this.setState(((t={})[m.VIZ_TYPE.CONTACT_MAP]=o({},this.state[m.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t[m.VIZ_TYPE.NGL]=o({},this.state[m.VIZ_TYPE.NGL],{isLoading:!0}),t)),[4,m.ChellPDB.createPDB(i)]):[3,2];case 1:return s=l.sent(),c=s.amendPDBWithCouplingScores(this.state[m.VIZ_TYPE.CONTACT_MAP].couplingScores.rankedContacts,r),this.setState(((n={})[m.VIZ_TYPE.CONTACT_MAP]={couplingScores:c,isLoading:!1,pdbData:s,secondaryStructures:s.secondaryStructureSections},n[m.VIZ_TYPE.NGL]={isLoading:!1,pdbData:s.nglStructure},n.errorMsg="",n.filenames=o({},this.state.filenames,{pdb:i.name}),n.pdbData=s,n)),[3,3];case 2:this.setState({errorMsg:"Unable to load PDB file '"+i.name+"' - Make sure the file ends in '.pdb'!"}),l.label=3;case 3:return e.target.value="",[2]}})})},r.onMeasuredProximityChange=function(){return function(e){r.setState({measuredProximity:Object.values(m.CONTACT_DISTANCE_PROXIMITY)[e]})}},r.onResidueMappingUpload=function(e){return s(r,void 0,void 0,function(){var t,n,r,a,i,s,c,u,d,p,g,h;return l(this,function(l){switch(l.label){case 0:if(e.persist(),r=this.state,a=r.measuredProximity,i=r.pdbData,s=e.target.files,c=s?s.item(0):null,u=["csv","indextable","indextableplus"],null===c)return[3,6];if(!u.reduce(function(e,t){return e||c.name.endsWith("."+t)},!1))return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),this.setState(((t={})[m.VIZ_TYPE.CONTACT_MAP]=o({},this.state[m.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,m.readFileAsText(c)];case 2:return d=l.sent(),p=m.generateResidueMapping(d),g=m.getCouplingScoresData(this.state.couplingScores,p),this.setState(((n={})[m.VIZ_TYPE.CONTACT_MAP]={couplingScores:i?i.amendPDBWithCouplingScores(g.rankedContacts,a):g,isLoading:!1,secondaryStructures:[]},n.errorMsg="",n.filenames=o({},this.state.filenames,{residue_mapper:c.name}),n.residueMapping=p,n)),[3,4];case 3:return h=l.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Residue Mapping file '"+c.name+"' - Make sure the file ends in one of the following: '"+u.join("', '")+"'"}),l.label=6;case 6:return e.target.value="",[2]}})})},r.state=t.initialState,r}return i(t,e),t.prototype.componentDidUpdate=function(e,t){var n,r=this.state,a=r.measuredProximity,i=r.pdbData,o=this.state[m.VIZ_TYPE.CONTACT_MAP].couplingScores,s="",l=this.state.mismatches,c=this.state.isResidueMappingNeeded;!i||o===t[m.VIZ_TYPE.CONTACT_MAP].couplingScores&&i===t.pdbData||(l=m.getPDBAndCouplingMismatch(i,o)).length>=1&&(s="Error details: "+l.length+" mismatch(es) detected between coupling scores and PDB!        For example, residue number "+l[0].resno+" is '"+l[0].secondAminoAcid.threeLetterCode+"' in the PDB but '"+l[0].firstAminoAcid.threeLetterCode+"' in the coupling scores file.",c=!0),i&&a!==t.measuredProximity?this.setState(((n={})[m.VIZ_TYPE.CONTACT_MAP]={couplingScores:i.amendPDBWithCouplingScores(o.rankedContacts,a),isLoading:!1,pdbData:this.state.pdbData,secondaryStructures:[]},n.errorMsg=s,n.isResidueMappingNeeded=c,n.mismatches=l,n)):s.length>=1&&this.setState({errorMsg:s,isResidueMappingNeeded:c,mismatches:l})},t.prototype.render=function(e){var t=(void 0===e?this.props:e).style;return u.createElement("div",{id:"ChellVizApp",style:o({},t,{height:"1000px"})},this.renderCouplingComponents(),u.createElement(m.ProteinFeatureViewer,null))},t.defaultProps={style:{backgroundColor:"#ffffff"}},t.initialState=((a={})[m.VIZ_TYPE.CONTACT_MAP]={couplingScores:new m.CouplingContainer,isLoading:!1,pdbData:void 0,secondaryStructures:[]},a[m.VIZ_TYPE.NGL]={isLoading:!1,pdbData:void 0},a.arePredictionsAvailable=!1,a.couplingScores="",a.errorMsg="",a.filenames={},a.isResidueMappingNeeded=!1,a.measuredProximity=m.CONTACT_DISTANCE_PROXIMITY.CLOSEST,a.mismatches=[],a.pdbData=void 0,a.residueMapping=[],a),t}(u.Component);d.render(u.createElement(g,null),document.getElementById("example-root"))}},[["./examples/example.tsx",7,1,0]]]);