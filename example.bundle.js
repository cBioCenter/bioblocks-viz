(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"./examples/example.tsx":function(e,t,n){"use strict";var r,a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,s)}l((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=n("./node_modules/react/index.js"),c=n("./node_modules/react-dom/index.js"),u=n("./node_modules/semantic-ui-react/dist/es/index.js"),d=n("./src/index.ts"),p=function(e){function t(n){var r=e.call(this,n)||this;return r.renderCouplingComponents=function(e,t){var n=(void 0===e?r.props:e).style,a=void 0===t?r.state:t,i=a.arePredictionsAvailable,o=a.couplingScores,s=a.errorMsg,c=a.isResidueMappingNeeded,p=a.measuredProximity,m=a.pdbData;return console.log(p),l.createElement("div",null,l.createElement(u.Header,{as:"h1",attached:"top"},"ContactMap.org: 2D and 3D Visualization"),s.length>1&&r.renderErrorMessage(),!m&&0===o.length&&r.renderStartMessage(),l.createElement(u.Segment,{attached:!0,raised:!0},l.createElement(d.CouplingContextProvider,null,l.createElement(d.SecondaryStructureContextConsumer,null,function(e){return l.createElement(d.ResidueContextConsumer,null,function(t){return l.createElement(u.Grid,{centered:!0},r.renderUploadButtonsRow(c,t,e),r.renderChellComponents(n,i,p,m))})}))),l.createElement("footer",null,"Powered by ",l.createElement("a",{href:"https://github.com/cBioCenter/chell-viz"},"Chell")))},r.renderErrorMessage=function(e){var t=void 0===e?r.state:e,n=t.errorMsg,a=t.isResidueMappingNeeded,i=t.pdbData;return l.createElement(u.Message,{warning:!0},a&&i?l.createElement("div",null,l.createElement(u.Message.Header,null,"Residue numbering mismatch detected - Please upload a file to correct the position numbering differences.",l.createElement("br",null),"This file should have been part of the an EVCouplings job run and might look like\n              '"+i.name+".csv' or '"+i.name+".indextableplus'"),l.createElement(u.Message.List,null,n),l.createElement(u.Message.Content,null,l.createElement(u.Accordion,{fluid:!0,exclusive:!1,defaultActiveIndex:[],panels:[r.renderSequenceAccordionMessage("PDB",i.sequence),r.renderSequenceAccordionMessage("Couplings Score",r.state[d.VIZ_TYPE.CONTACT_MAP].couplingScores.sequence)]}))):n)},r.renderSequenceAccordionMessage=function(e,t){return{content:{content:l.createElement(u.TextArea,{style:{width:"90%"},value:t})},key:"panel-"+e,title:{content:e+" ("+t.length+" Amino Acids)"}}},r.renderStartMessage=function(){return l.createElement(u.Message,null,"To get started, please upload either a PDB (.pdb) or EVCouplings score (.csv) file!"," ",l.createElement("br",null)," Check out the",l.createElement("a",{href:"evfold.org"}," EVFold"),", ",l.createElement("a",{href:"sanderlab.org/contact-maps/"},"Sander Lab"),", or",l.createElement("a",{href:"https://evcouplings.org/"}," EVCouplings ")," website to get these files.")},r.renderUploadForm=function(e,t,n,r,a){return void 0===a&&(a=[]),l.createElement(u.GridColumn,null,l.createElement(u.Label,{as:"label",basic:!0,htmlFor:t},l.createElement(u.Button,{disabled:r,icon:"upload",label:{basic:!0,content:n},labelPosition:"right"}),l.createElement("input",{accept:"."+a.join(",."),disabled:r,id:t,onChange:e,hidden:!0,type:"file",required:!0,multiple:!1})))},r.renderUploadLabel=function(e){return e?l.createElement(u.GridColumn,{verticalAlign:"middle",textAlign:"justified"},l.createElement(u.Label,null,e)):null},r.renderCouplingScoresUploadForm=function(e){var t=void 0===e?r.state:e,n=t.couplingScores,a=t.filenames;return l.createElement(u.GridRow,null,r.renderUploadLabel(a.couplings),r.renderUploadForm(r.onCouplingScoreUpload,"coupling-score","Coupling Scores",n.length>0,["csv"]))},r.renderChellComponents=function(e,t,n,a){return l.createElement(u.GridRow,{verticalAlign:"middle"},l.createElement(u.GridColumn,{width:6},l.createElement(u.Card,{raised:!0,style:{padding:"10px 14px",height:"660px",width:"600px"}},l.createElement(d.NGLComponent,{data:r.state[d.VIZ_TYPE.NGL].pdbData,isDataLoading:r.state[d.VIZ_TYPE.NGL].isLoading,measuredProximity:n,onMeasuredProximityChange:r.onMeasuredProximityChange(),style:i({},e,{height:"600px",width:"600px"})}))),l.createElement(u.GridColumn,{width:6},l.createElement(u.Card,{raised:!0,style:{padding:"10px 14px",height:"660px",width:"600px"}},t?l.createElement(d.PredictedContactMap,{data:{couplingScores:r.state[d.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:a,secondaryStructures:r.state[d.VIZ_TYPE.CONTACT_MAP].secondaryStructures},height:590,isDataLoading:r.state[d.VIZ_TYPE.CONTACT_MAP].isLoading,style:e,width:580}):l.createElement(d.ContactMap,{data:{couplingScores:r.state[d.VIZ_TYPE.CONTACT_MAP].couplingScores,pdbData:a,secondaryStructures:r.state[d.VIZ_TYPE.CONTACT_MAP].secondaryStructures},height:585,isDataLoading:r.state[d.VIZ_TYPE.CONTACT_MAP].isLoading,style:e,width:585}))))},r.renderUploadButtonsRow=function(e,t,n){return l.createElement(u.GridRow,{columns:4,centered:!0,textAlign:"center",verticalAlign:"bottom"},l.createElement(u.GridColumn,null,r.renderPDBUploadForm()),l.createElement(u.GridColumn,null,r.renderCouplingScoresUploadForm()),e&&l.createElement(u.GridColumn,null,r.renderResidueMappingUploadForm()),l.createElement(u.GridColumn,null,r.renderClearAllButton(t,n)))},r.renderPDBUploadForm=function(e){var t=void 0===e?r.state:e,n=t.filenames,a=t.pdbData;return l.createElement(u.GridRow,null,r.renderUploadLabel(n.pdb),r.renderUploadForm(r.onPDBUpload,"pdb","PDB",void 0!==a,["pdb"]))},r.renderResidueMappingUploadForm=function(e){var t=(void 0===e?r.state:e).filenames;return l.createElement(u.GridRow,{verticalAlign:"middle",columns:1,centered:!0},r.renderUploadLabel(t.residue_mapper),r.renderUploadForm(r.onResidueMappingUpload,"residue-mapping","Residue Mapping",!1,["csv","indextable","indextableplus"]))},r.renderClearAllButton=function(e,t){return l.createElement(u.GridRow,{verticalAlign:"middle",columns:1,centered:!0},l.createElement(u.GridColumn,null,l.createElement(u.Label,{as:"label",basic:!0,htmlFor:"clear-data"},l.createElement(u.Button,{icon:"trash",label:{basic:!0,content:"Clean View"},labelPosition:"right",onClick:r.onClearAll(e,t)}))))},r.onClearAll=function(e,n){return function(){return o(r,void 0,void 0,function(){return s(this,function(r){return this.setState(t.initialState),e.clearAllResidues(),n.clearSecondaryStructure(),this.forceUpdate(),[2]})})}},r.onCouplingScoreUpload=function(e){return o(r,void 0,void 0,function(){var t,n,r,a,o,l,c,u,p,m,g,h;return s(this,function(s){switch(s.label){case 0:if(e.persist(),r=this.state,a=r.measuredProximity,o=r.pdbData,l=e.target.files,null===(c=l?l.item(0):null))return[3,6];if(!c.name.endsWith(".csv"))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),this.setState(((t={})[d.VIZ_TYPE.CONTACT_MAP]=i({},this.state[d.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,d.readFileAsText(c)];case 2:return u=s.sent(),p=d.getCouplingScoresData(u,this.state.residueMapping),m=o?o.getResidueNumberingMismatches(p):[],g=m.length>0,this.setState(((n={})[d.VIZ_TYPE.CONTACT_MAP]={couplingScores:o?o.amendPDBWithCouplingScores(p.rankedContacts,a):p,isLoading:!1,pdbData:this.state.pdbData,secondaryStructures:[]},n.arePredictionsAvailable=!0,n.couplingScores=u,n.errorMsg="",n.filenames=i({},this.state.filenames,{couplings:c.name}),n.isResidueMappingNeeded=g,n)),[3,4];case 3:return h=s.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Coupling Score file '"+c.name+"' - Make sure the file ends in '.csv'!"}),s.label=6;case 6:return e.target.value="",[2]}})})},r.onPDBUpload=function(e){return o(r,void 0,void 0,function(){var t,n,r,a,o,l,c;return s(this,function(s){switch(s.label){case 0:return e.persist(),r=this.state.measuredProximity,a=e.target.files,null===(o=a?a.item(0):null)?[3,3]:o.name.endsWith(".pdb")?(this.setState(((t={})[d.VIZ_TYPE.CONTACT_MAP]=i({},this.state[d.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t[d.VIZ_TYPE.NGL]=i({},this.state[d.VIZ_TYPE.NGL],{isLoading:!0}),t)),[4,d.ChellPDB.createPDB(o)]):[3,2];case 1:return l=s.sent(),c=l.amendPDBWithCouplingScores(this.state[d.VIZ_TYPE.CONTACT_MAP].couplingScores.rankedContacts,r),this.setState(((n={})[d.VIZ_TYPE.CONTACT_MAP]={couplingScores:c,isLoading:!1,pdbData:l,secondaryStructures:l.secondaryStructureSections},n[d.VIZ_TYPE.NGL]={isLoading:!1,pdbData:l.nglStructure},n.errorMsg="",n.filenames=i({},this.state.filenames,{pdb:o.name}),n.pdbData=l,n)),[3,3];case 2:this.setState({errorMsg:"Unable to load PDB file '"+o.name+"' - Make sure the file ends in '.pdb'!"}),s.label=3;case 3:return e.target.value="",[2]}})})},r.onMeasuredProximityChange=function(){return function(e){console.log("Changing measured prox to "+e),r.setState({measuredProximity:Object.values(d.CONTACT_DISTANCE_PROXIMITY)[e]})}},r.onResidueMappingUpload=function(e){return o(r,void 0,void 0,function(){var t,n,r,a,o,l,c,u,p,m,g,h;return s(this,function(s){switch(s.label){case 0:if(e.persist(),r=this.state,a=r.measuredProximity,o=r.pdbData,l=e.target.files,c=l?l.item(0):null,u=["csv","indextable","indextableplus"],null===c)return[3,6];if(!u.reduce(function(e,t){return e||c.name.endsWith("."+t)},!1))return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),this.setState(((t={})[d.VIZ_TYPE.CONTACT_MAP]=i({},this.state[d.VIZ_TYPE.CONTACT_MAP],{isLoading:!0}),t)),[4,d.readFileAsText(c)];case 2:return p=s.sent(),m=d.generateResidueMapping(p),g=d.getCouplingScoresData(this.state.couplingScores,m),this.setState(((n={})[d.VIZ_TYPE.CONTACT_MAP]={couplingScores:o?o.amendPDBWithCouplingScores(g.rankedContacts,a):g,isLoading:!1,secondaryStructures:[]},n.errorMsg="",n.filenames=i({},this.state.filenames,{residue_mapper:c.name}),n.residueMapping=m,n)),[3,4];case 3:return h=s.sent(),console.log(h),[3,4];case 4:return[3,6];case 5:this.setState({errorMsg:"Unable to load Residue Mapping file '"+c.name+"' - Make sure the file ends in one of the following: '"+u.join("', '")+"'"}),s.label=6;case 6:return e.target.value="",[2]}})})},r.state=t.initialState,r}return a(t,e),t.prototype.componentDidUpdate=function(e,t){var n,r=this.state,a=r.measuredProximity,i=r.pdbData,o=this.state[d.VIZ_TYPE.CONTACT_MAP].couplingScores,s="",l=this.state.isResidueMappingNeeded;if(i&&(o!==t[d.VIZ_TYPE.CONTACT_MAP].couplingScores||i!==t.pdbData)){var c=i.getResidueNumberingMismatches(o);c.length>=1&&(s=c.length+" mismatches detected between coupling scores and PDB!        For example, residue number "+c[0].resno+" is '"+c[0].pdbAminoAcid.threeLetterCode+"' in the PDB but '"+c[0].couplingAminoAcid.threeLetterCode+"' in the coupling scores file.",l=!0)}i&&a!==t.measuredProximity?this.setState(((n={})[d.VIZ_TYPE.CONTACT_MAP]={couplingScores:i.amendPDBWithCouplingScores(o.rankedContacts,a),isLoading:!1,pdbData:this.state.pdbData,secondaryStructures:[]},n.errorMsg=s,n.isResidueMappingNeeded=l,n)):s.length>=1&&this.setState({errorMsg:s,isResidueMappingNeeded:l})},t.prototype.render=function(e){var t=(void 0===e?this.props:e).style;return l.createElement("div",{id:"ChellVizApp",style:i({},t,{height:"1000px"})},this.renderCouplingComponents())},t.defaultProps={style:{backgroundColor:"#ffffff"}},t.initialState=((r={})[d.VIZ_TYPE.CONTACT_MAP]={couplingScores:new d.CouplingContainer,isLoading:!1,pdbData:void 0,secondaryStructures:[]},r[d.VIZ_TYPE.NGL]={isLoading:!1,pdbData:void 0},r.arePredictionsAvailable=!1,r.couplingScores="",r.errorMsg="",r.filenames={},r.isResidueMappingNeeded=!1,r.measuredProximity=d.CONTACT_DISTANCE_PROXIMITY.CLOSEST,r.pdbData=void 0,r.residueMapping=[],r),t}(l.Component);c.render(l.createElement(p,null),document.getElementById("example-root"))},"./src/ChellVizApp.tsx":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n("./node_modules/react/index.js"),i=n("./node_modules/semantic-ui-react/dist/es/index.js"),o=n("./src/container/index.ts"),s=n("./src/data/index.ts"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){return a.createElement("div",{id:"ChellVizApp"},a.createElement(i.Grid,{centered:!0,divided:"vertically"},a.createElement(i.GridRow,null,a.createElement(o.ProteinFeatureViewer,null)),a.createElement(i.GridRow,null,a.createElement(o.VizPanelContainer,{dataDirs:["hpc/full"].map(function(e){return"assets/datasets/"+e}),initialVisualizations:[s.VIZ_TYPE["T-SNE"],s.VIZ_TYPE.SPRING,s.VIZ_TYPE["T-SNE-FRAME"]],supportedVisualizations:[s.VIZ_TYPE["T-SNE"],s.VIZ_TYPE.SPRING,s.VIZ_TYPE["T-SNE-FRAME"]],numPanels:3})),a.createElement(i.GridRow,null,a.createElement(o.VizPanelContainer,{dataDirs:["assets/beta_lactamase","assets/5P21","assets/P01112"],supportedVisualizations:[s.VIZ_TYPE.CONTACT_MAP,s.VIZ_TYPE.NGL],initialVisualizations:[s.VIZ_TYPE.CONTACT_MAP,s.VIZ_TYPE.NGL],numPanels:2}))))},t}(a.Component);t.ChellVizApp=l},"./src/index.ts":function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n("./src/component/index.ts")),r(n("./src/container/index.ts")),r(n("./src/context/index.ts")),r(n("./src/data/index.ts")),r(n("./src/helper/index.ts")),r(n("./src/hoc/index.ts")),r(n("./src/ChellVizApp.tsx"))}},[["./examples/example.tsx",6,0,1]]]);